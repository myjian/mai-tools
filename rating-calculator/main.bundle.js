(()=>{"use strict";var e={9640:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,".otherToolsHeading {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.toolItem {\r\n  font-size: 22px;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.toolItem a {\r\n  color: rgb(0, 56, 216);\r\n}\r\n\r\n.toolItem a:visited {\r\n  color: rgb(0, 56, 216);\r\n}\r\n\r\nfooter {\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.authorLink {\r\n  color: inherit;\r\n}\r\n\r\n.authorLink:visited {\r\n  color: inherit;\r\n}\r\n",""]);const l=i},2701:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,".inputSelectTable {\r\n  border-style: none;\r\n}\r\n\r\n.w90 {\r\n  width: 90%;\r\n  position: relative;\r\n}\r\n\r\ntextarea {\r\n  width: 100%;\r\n  min-height: 140px;\r\n  display: block;\r\n  padding: 4px;\r\n  box-sizing: border-box;\r\n}\r\n\r\ntextarea:focus {\r\n  outline-color: #c179ca;\r\n  outline-offset: -1px;\r\n  outline-style: solid;\r\n  outline-width: 2px;\r\n}\r\n\r\n.lvInputHeading,\r\n.scoreInputHeading {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.lvInput {\r\n  margin-top: 14px;\r\n}\r\n\r\n.playedToggleForm {\r\n  margin-bottom: 16px;\r\n  padding-left: 4px;\r\n}\r\n\r\n.radioLabel:first-child {\r\n  margin-right: 20px;\r\n}\r\n\r\n.radioInput {\r\n  margin-right: 8px;\r\n}\r\n\r\n.scoreInputArea {\r\n  margin-top: 18px;\r\n  font-size: 13px;\r\n}\r\n\r\n.actionArea {\r\n  padding-top: 22px;\r\n}\r\n\r\n.analyzeRatingBtn {\r\n  font-size: 28px;\r\n  padding: 8px 20px;\r\n  background-color: #ffc542;\r\n}\r\n\r\nselect {\r\n  display: block;\r\n  margin-bottom: 4px;\r\n}\r\n",""]);const l=i},9381:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,".rankDistributionTable {\r\n  margin-bottom: 22px;\r\n}\r\n\r\n.rankDistributionTable:first-child {\r\n  margin-right: 40px;\r\n}\r\n\r\n.levelRankCell {\r\n  padding: 4px;\r\n  width: 60px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.diffRankCell {\r\n  padding: 4px 10px;\r\n}\r\n\r\ntd.levelRankCell,\r\ntd.diffRankCell {\r\n  text-align: center;\r\n}\r\n\r\n.officialLevelCell {\r\n  width: unset;\r\n  padding-right: 12px;\r\n  padding-left: 12px;\r\n}\r\n\r\n.totalCell {\r\n  width: 80px;\r\n}\r\n\r\ntd.totalCell {\r\n  color: rgba(0, 0, 0, 0.8);\r\n  text-shadow: none;\r\n}\r\n",""]);const l=i},9721:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,".ratingOverview {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n}\r\n\r\n.totalRatingRow {\r\n  font-size: 20px;\r\n  background-color: #111;\r\n  display: inline-block;\r\n  color: #eee;\r\n  padding: 5px 20px;\r\n  margin-bottom: 6px;\r\n  cursor: pointer;\r\n}\r\n\r\n.ratingOverviewTable {\r\n  border-style: none;\r\n}\r\n\r\n.columnColumn {\r\n  padding-right: 4px;\r\n}\r\n\r\n.subRatingColumn {\r\n  text-align: right;\r\n}\r\n\r\n.avgRatingColumn {\r\n  padding-left: 16px;\r\n}\r\n",""]);const l=i},9521:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,".recLvSection {\r\n  margin-bottom: 35px;\r\n}\r\n\r\n.recLvTitle {\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.recLvDesc {\r\n  margin: 10px 0 0 4px;\r\n  max-height: 999px;\r\n}\r\n\r\n.recLvTable {\r\n  table-layout: fixed;\r\n}\r\n\r\n.recLvTable th,\r\n.recLvTable td {\r\n  min-width: 64px;\r\n  padding: 4px 16px;\r\n  box-sizing: border-box;\r\n  text-align: center;\r\n}\r\n\r\n.recLvRankTitle,\r\n.recLvRankAchv {\r\n  display: block;\r\n}\r\n",""]);const l=i},2661:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,"@keyframes rotationExpand {\r\n  from {\r\n    transform: rotate(0);\r\n  }\r\n  to {\r\n    transform: rotate(0.25turn);\r\n  }\r\n}\r\n@keyframes rotationCollapse {\r\n  from {\r\n    transform: rotate(0.25turn);\r\n  }\r\n  to {\r\n    transform: rotate(0);\r\n  }\r\n}\r\n\r\n.songRecordsContainer {\r\n  margin-top: 0;\r\n}\r\n\r\n.crSecTitleContainer {\r\n  margin: 4px 0 16px;\r\n  padding: 0;\r\n}\r\n\r\n.crSecTitle {\r\n  cursor: pointer;\r\n  padding: 0 4px;\r\n  display: inline-block;\r\n}\r\n\r\n.crSecTitle:focus {\r\n  color: inherit;\r\n}\r\n\r\n.crSecTitle:active {\r\n  background-color: transparent;\r\n}\r\n\r\n.crSecTitleSymbol {\r\n  display: inline-block;\r\n  position: relative;\r\n  transform: rotate(0.25turn);\r\n  line-height: 32px;\r\n  width: 32px;\r\n  text-align: center;\r\n  transition: bottom 0.3s;\r\n  bottom: 2px;\r\n}\r\n\r\n.crSecTitleSymbol.crSecHidden {\r\n  transform: rotate(0);\r\n  bottom: 1px;\r\n  animation-name: rotationCollapse;\r\n  animation-duration: 0.3s;\r\n}\r\n\r\n.crSecTitleSymbol.crSecShow {\r\n  animation-name: rotationExpand;\r\n  animation-duration: 0.3s;\r\n}\r\n\r\n.songRecordTableContainer {\r\n  margin-bottom: 35px;\r\n}\r\n\r\n.songRecordTableContainer.hidden {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.scoreRecordRow:nth-child(2n) {\r\n  background-color: rgba(90, 90, 90, 0.1);\r\n}\r\n\r\n.scoreRecordCell {\r\n  padding: 4px;\r\n  font-weight: bold;\r\n  box-sizing: border-box;\r\n  font-size: 1rem;\r\n}\r\n\r\n.scoreRecordCell[tabIndex] {\r\n  cursor: pointer;\r\n}\r\n\r\n.songTitleCell {\r\n  overflow: hidden;\r\n  padding-right: 10px;\r\n  word-break: break-word;\r\n}\r\n\r\n@media only screen and (min-width: 770px) {\r\n  .songTitleCell {\r\n    width: 300px;\r\n  }\r\n  .difficultyCell {\r\n    width: 110px;\r\n  }\r\n  .levelCell {\r\n    width: 70px;\r\n  }\r\n  .achievementCell {\r\n    width: 110px;\r\n  }\r\n  .rankCell {\r\n    width: 85px;\r\n  }\r\n  .ratingCell {\r\n    width: 70px;\r\n  }\r\n}\r\n\r\ntd.orderCell,\r\ntd.achievementCell {\r\n  text-align: right;\r\n}\r\n\r\ntd.difficultyCell,\r\ntd.levelCell,\r\ntd.ratingCell,\r\n.rankCell,\r\n.candidateTable .ratingCell {\r\n  text-align: center;\r\n}\r\n\r\n.songWikiLink {\r\n  color: inherit;\r\n  text-decoration: none;\r\n}\r\n\r\n.showMore {\r\n  display: inline-block;\r\n  margin-top: 10px;\r\n}\r\n",""]);const l=i},8861:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(3645),i=n.n(o)()(r());i.push([e.id,"html {\r\n  background-color: #eee;\r\n}\r\n\r\nbody {\r\n  font-family: 'ヒラギノ角ゴ Pro W3', 'メイリオ', Meiryo, 'Noto Sans CJK TC', '微軟正黑體',\r\n    'Microsoft Jhenghei', 'MS P Gothic', 'ＭＳ Ｐゴシック', sans-serif;\r\n}\r\n\r\nh2,\r\nh3 {\r\n  /* Work around an Android Chrome bug where span in heading has smaller font size */\r\n  max-height: 999px;\r\n}\r\n\r\nh2 {\r\n  font-size: 26px;\r\n}\r\n\r\nh3 {\r\n  font-size: 22px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\ntable {\r\n  border: 2px solid #999;\r\n}\r\n\r\ntbody th {\r\n  background-color: #dddddd;\r\n}\r\n\r\nthead {\r\n  background: #999;\r\n  color: #eee;\r\n}\r\n\r\nselect,\r\nlabel {\r\n  font-size: 18px;\r\n}\r\n\r\n#outputHeading {\r\n  margin-top: 8px;\r\n  margin-bottom: 12px;\r\n  padding-top: 12px;\r\n}\r\n\r\n.responsiveFlexBox {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.advanced {\r\n  color: #fb9c2d;\r\n}\r\n\r\n.expert {\r\n  color: #f64861;\r\n}\r\n\r\n.master {\r\n  color: #9e45e2;\r\n}\r\n\r\n.remaster {\r\n  color: white;\r\n  text-shadow: -1px -1px 2px #9e45e2, -1px 1px 2px #9e45e2, 1px -1px 2px #9e45e2,\r\n    1px 1px 2px #9e45e2;\r\n}\r\n\r\n.sectionSep {\r\n  margin-top: 35px;\r\n}\r\n\r\n.collapsibleContainer {\r\n  max-height: 15000px;\r\n}\r\n\r\n.collapsibleContainer.hidden {\r\n  max-height: 0;\r\n  overflow-y: hidden;\r\n  transition: max-height 0.3s;\r\n}\r\n\r\n.hidden {\r\n  display: none;\r\n}\r\n\r\n@media only screen and (min-width: 551px) {\r\n  body {\r\n    margin: 20px;\r\n  }\r\n  .responsiveFlexBox {\r\n    flex-direction: row;\r\n  }\r\n}\r\n",""]);const l=i},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);a&&i[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},8081:e=>{e.exports=function(e){return e[1]}},745:(e,t,n)=>{var a=n(1533);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},2195:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(9640),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},5904:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(2701),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},3662:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(9381),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},862:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(9721),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},1444:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(9521),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},8273:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(2661),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},2889:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(3379),r=n.n(a),o=n(7795),i=n.n(o),l=n(569),s=n.n(l),c=n(3565),u=n.n(c),d=n(9216),f=n.n(d),m=n(4589),g=n.n(m),h=n(8861),p={};p.styleTagTransform=g(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=f(),r()(h.Z,p);const v=h.Z&&h.Z.locals?h.Z.locals:void 0},3379:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var o={},i=[],l=0;l<e.length;l++){var s=e[l],c=a.base?s[0]+a.base:s[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var f=n(d),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)t[f].references++,t[f].updater(m);else{var g=r(m,a);a.byIndex=l,t.splice(l,0,{identifier:d,updater:g,references:1})}i.push(d)}return i}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=a(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var l=n(o[i]);t[l].references--}for(var s=a(e,r),c=0;c<o.length;c++){var u=n(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=s}}},569:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8190:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMaimaiSongsLink=t.MAIMAI_SONGS_HOME=void 0;const a=n(134);t.MAIMAI_SONGS_HOME="https://arcade-songs.zetaraku.dev/maimai/",t.getMaimaiSongsLink=function(e,n,r,o,i=a.LATEST_VERSION){const l=new URLSearchParams;if(e=e.replace("+",".7"),l.set("maxLevelValue",e),l.set("minLevelValue",e),n&&l.set("useInternalLevel","true"),r&&("https://maimaidx.jp"===r?l.set("region","jp"):"https://maimaidx-eng.com"===r&&l.set("region","intl")),null!=o&&o>=0){const e=[];for(;o<=i;)e.push((0,a.getVersionName)(o)),o++;l.set("versions",e.join("|"))}return t.MAIMAI_SONGS_HOME+"?"+l}},5666:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shuffleArray=void 0,t.shuffleArray=function(e){const t=e.slice(),n=t.length;for(let e=0;e<n;e++){const a=t[e],r=Math.floor(Math.random()*n);t[e]=t[r],t[r]=a}return t}},9099:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChartTypeName=t.getChartType=void 0,t.getChartType=function(e){if(e.id)return e.id.includes("sta_")?0:1;const t=e.querySelector(".playlog_music_kind_icon")||e.querySelector(".music_kind_icon")||e.querySelector(".f_l.h_20")||e.querySelector("img:nth-child(2)");return t instanceof HTMLImageElement&&t.src.includes("_standard")?0:1},t.getChartTypeName=function(e){return 1===e?"DX":"STANDARD"}},6699:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedLevelCell=void 0;const r=a(n(7363)),o=n(8190),i=n(9268);class l extends r.default.PureComponent{render(){const{gameRegion:e,gameVer:t,lv:n,includeOldVersions:a}=this.props;if(n<0)return r.default.createElement("td",null,"--");const l=(0,i.getOfficialLevel)(n),s=n.toFixed(1),c=a?0:t;return r.default.createElement("td",{className:"recLvCell"},r.default.createElement("a",{className:"recOfficialLv",href:(0,o.getMaimaiSongsLink)(l,!1,e,c,t),target:"_blank"},l),r.default.createElement("br",null),"(",r.default.createElement("a",{href:(0,o.getMaimaiSongsLink)(s,!0,e,c,t),target:"_blank"},s),"~)")}}t.RecommendedLevelCell=l},8642:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDifficultyTextColor=t.getDifficultyForRecord=t.getDifficultyByName=t.getDifficultyName=t.DIFFICULTY_CLASSNAME_MAP=t.DIFFICULTIES=void 0,t.DIFFICULTIES=[0,1,2,3,4];const n=["BASIC","ADVANCED","EXPERT","MASTER","Re:MASTER"];function a(e){const t=n.indexOf(e.toUpperCase());return t<0?4:t}t.DIFFICULTY_CLASSNAME_MAP=new Map([[0,"basic"],[1,"advanced"],[2,"expert"],[3,"master"],[4,"remaster"]]),t.getDifficultyName=function(e){return n[e]},t.getDifficultyByName=a,t.getDifficultyForRecord=function(e){const t=e.querySelector(".playlog_top_container img.playlog_diff").src;return a(t.substring(t.lastIndexOf("_")+1,t.lastIndexOf(".")))},t.getDifficultyTextColor=function(e){return["#45c124","#ffba01","#ff7b7b","#9f51dc","#dbaaff"][e]}},271:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateDetailedDxStar=t.getDxStarText=t.determineDxStar=void 0;const n=[0,.85,.9,.93,.95,.97,.99,1];function a(e){for(let t=n.length-1;t>0;t--)if(e>=n[t])return t;return 0}t.determineDxStar=a,t.getDxStarText=function(e,t=!1){return t||e?`✦${e}`:""},t.calculateDetailedDxStar=function(e){const t=e.querySelector(".playlog_result_innerblock .playlog_score_block");if(!t)return 0;const n=t.querySelector(".w_80");if(!n)return;n.remove();const[r,o]=t.textContent.split("/").map((e=>parseInt(e.replace(",","").trim()))),i=r/o,l=a(i),s=`✦${l} (${(100*i).toFixed(1)}%)`,c=document.createElement("div");return c.className="white p_r_5 f_15 f_l",c.append(s),t.prepend(c),l}},2347:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncStatus=t.getApFcStatus=t.getAchievement=t.getPlayerGrade=t.getPlayerName=t.getChartDifficulty=t.getChartLevel=t.getSongName=void 0;const a=n(8642),r=n(472);t.getSongName=function(e){const t=e.querySelector(".basic_block.break");return t?t.childNodes.item(t.childNodes.length-1).nodeValue:(0,r.normalizeSongName)(e.getElementsByClassName("music_name_block")[0].innerText)},t.getChartLevel=function(e){return e.getElementsByClassName("music_lv_block")[0].innerText},t.getChartDifficulty=function(e){if(!e.classList.contains("pointer")){const t=e.querySelector(".pointer");e=t||e}const t=e.className.match(/music_([a-z]+)_score_back/)[1];return(0,a.getDifficultyByName)(t)},t.getPlayerName=function(e){var t,n;return e.className.includes("friend_vs_friend_block")?null===(t=e.querySelector(".t_l"))||void 0===t?void 0:t.innerText:null===(n=e.querySelector(".name_block"))||void 0===n?void 0:n.innerText},t.getPlayerGrade=function(e){const t=e.querySelector(".user_data_block_line ~ img.h_25");if(t){const e=t.src.lastIndexOf("grade_");return t.src.substring(e+6,e+8)}return null},t.getAchievement=function(e,t=!1){const n=t?e.querySelector("tr:first-child td:last-child"):e.querySelector(".music_score_block.w_120");return n instanceof HTMLElement?parseFloat(n.innerText):0},t.getApFcStatus=function(e,t=!1){const n=t?e.querySelector("tr:last-child td:last-child img:nth-child(2)"):e.children[0].querySelector("img.f_r:nth-last-of-type(2)");if(!n)return null;const a=n.src.replace(/\?ver=.*$/,""),r=a.lastIndexOf("_"),o=a.lastIndexOf("."),i=a.substring(r+1,o);return"back"===i?null:i.replace("ap","AP").replace("p","+").toUpperCase()},t.getSyncStatus=function(e,t=!1){const n=t?e.querySelector("tr:last-child td:last-child img:first-child"):e.children[0].querySelector("img.f_r:nth-last-of-type(3)");if(!n)return null;const a=n.src.replace(/\?ver=.*$/,""),r=a.lastIndexOf("_"),o=a.lastIndexOf("."),i=a.substring(r+1,o);return"back"===i?null:i.replace("sd","DX").replace("p","+").toUpperCase()}},6510:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchScoresFull=t.fetchScores=t.getMyDxScoreInfo=t.SELF_SCORE_URLS=void 0;const r=n(9099),o=n(271),i=n(2347),l=n(9268),s=n(6991);function c(e){const t=e.querySelectorAll(".music_score_block");if(2!==t.length)return null;const n=t[1].childNodes,a=n[n.length-1],r=a instanceof Text?a.wholeText.split("/").map((e=>e.replace(",","").trim())):[];if(2!==r.length)return null;try{const e=parseInt(r[0]),t=parseInt(r[1]);if(isNaN(e)||isNaN(t))throw new Error(`failed to parse DX score. Input was ${JSON.stringify(r)}`);const n=e/t;return{max:t,player:e,ratio:n,star:(0,o.determineDxStar)(n)}}catch(e){console.warn(e)}return{max:0,player:0,ratio:0,star:0}}function u(e,t,n,a){const o=e.classList.contains("screw_block"),s=e.classList.contains("w_450")&&e.classList.contains("m_15")&&e.classList.contains("p_r")&&e.classList.contains("f_0");if(o)return a.genre=e.innerText,null;if(s){const o=(0,i.getAchievement)(e);if(!o)return;const s=(0,i.getSongName)(e),c=(0,r.getChartType)(e),u=n.getSongProperties(s,a.genre,c);let d=u?u.lv[t]:0;const f=d>0;return d||(d=(0,l.getDefaultLevel)((0,i.getChartLevel)(e))),{songName:s,genre:a.genre,difficulty:t,level:d,levelIsPrecise:f,chartType:c,achievement:o}}}t.SELF_SCORE_URLS=new Map([[4,"/maimai-mobile/record/musicGenre/search/?genre=99&diff=4"],[3,"/maimai-mobile/record/musicGenre/search/?genre=99&diff=3"],[2,"/maimai-mobile/record/musicGenre/search/?genre=99&diff=2"],[1,"/maimai-mobile/record/musicGenre/search/?genre=99&diff=1"],[0,"/maimai-mobile/record/musicGenre/search/?genre=99&diff=0"]]),t.getMyDxScoreInfo=c,t.fetchScores=function(e,n,r){return a(this,void 0,void 0,(function*(){let a=n.get(e);if(!a){const r=t.SELF_SCORE_URLS.get(e);if(!r)return;a=yield(0,s.fetchPage)(r),n.set(e,a)}const o=a.querySelectorAll(".main_wrapper.t_c .m_15"),i={genre:""};return Array.from(o).map((t=>u(t,e,r,i))).filter((e=>null!=e))}))},t.fetchScoresFull=function(e,n,r){return a(this,void 0,void 0,(function*(){let a=n.get(e);if(!a){const r=t.SELF_SCORE_URLS.get(e);if(!r)return;a=yield(0,s.fetchPage)(r),n.set(e,a)}const o=a.querySelectorAll(".main_wrapper.t_c .m_15"),l={genre:""},d=Array.from(o).map((t=>function(e,t,n,a){const r=u(e,t,n,a);if(null==r)return null;const o=n.getSongProperties(r.songName,a.genre,r.chartType);return Object.assign(Object.assign({},r),{fcap:(0,i.getApFcStatus)(e),sync:(0,i.getSyncStatus)(e),dxscore:c(e),version:o?o.debut:-1})}(t,e,r,l)));return d.filter((e=>null!=e))}))}},6162:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGameRegionFromOrigin=t.isMaimaiNetOrigin=t.MAIMAI_NET_ORIGINS=void 0,t.MAIMAI_NET_ORIGINS=["https://maimaidx.jp","https://maimaidx-eng.com"],t.isMaimaiNetOrigin=function(e){return"https://maimaidx.jp"===e||"https://maimaidx-eng.com"===e},t.getGameRegionFromOrigin=function(e){return"https://maimaidx.jp"===e?"https://maimaidx.jp":"https://maimaidx-eng.com"}},134:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionName=t.validateGameVersion=t.RATING_CALCULATOR_SUPPORTED_VERSIONS=t.LATEST_VERSION=void 0;const n=["maimai","maimai PLUS","GreeN","GreeN PLUS","ORANGE","ORANGE PLUS","PiNK","PiNK PLUS","MURASAKi","MURASAKi PLUS","MiLK","MiLK PLUS","FiNALE","maimaiでらっくす","maimaiでらっくす PLUS","Splash","Splash PLUS","UNiVERSE","UNiVERSE PLUS","FESTiVAL","FESTiVAL PLUS"];t.LATEST_VERSION=20,t.RATING_CALCULATOR_SUPPORTED_VERSIONS=[18,19,20],t.validateGameVersion=function(e,n,a=t.LATEST_VERSION){const r="string"==typeof e?parseInt(e):e;return!e||isNaN(r)?a:r>=n&&r<=a?r:a},t.getVersionName=function(e){return n[e]}},5215:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useLanguage=t.LangContext=void 0;const a=n(7363),r=n(8080);t.LangContext=(0,a.createContext)((0,r.getInitialLanguage)()),t.useLanguage=function(){return(0,a.useContext)(t.LangContext)}},8080:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialLanguage=t.saveLanguage=t.SUPPORTED_LANGUAGES=void 0;const a=n(5990);t.SUPPORTED_LANGUAGES=["en_US","zh_TW","ko_KR"],t.saveLanguage=function(e){(0,a.saveUserPreference)("MaiToolsLang",e)},t.getInitialLanguage=function(){const e=new URLSearchParams(location.search).get("hl");if(e)return e.startsWith("zh")?"zh_TW":e.startsWith("ko")?"ko_KR":"en_US";return function(){switch((0,a.loadUserPreference)("MaiToolsLang")){case"en_US":return"en_US";case"zh_TW":return"zh_TW";case"ko_KR":return"ko_KR"}return null}()||(navigator.language.startsWith("zh")?"zh_TW":navigator.language.startsWith("ko")?"ko_KR":"en_US")}},9268:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDisplayLv=t.getDefaultLevel=t.getOfficialLevel=t.MAX_LEVEL=void 0,t.MAX_LEVEL=15,t.getOfficialLevel=function(e){const t=Math.floor(e);return e-t>.6?t+"+":t.toString()},t.getDefaultLevel=function(e){if(!e)return 1;const t=parseInt(e);return e.endsWith("+")?t+.7:t},t.getDisplayLv=function(e,t=!1){return(t=t||e<0)?Math.abs(e).toFixed(1)+"~":e.toFixed(1)}},6685:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.loadMagic=void 0;const r=n(8642),o=n(134),i=n(472),l="magicExpire",s=["dxLv15","dxLv16","dxLv17","dxLv18","dxLv19","dxLv20"],c={13:null,18:"aHR0cHM6Ly9naXN0LmdpdGh1YnVzZXJjb250ZW50LmNvbS9teWppYW4vZWU1NjlkNzRmNDIyZDRlMjU1MDY1ZDhiMDJlYTI5NGEvcmF3LzkzMmZiMDNhMzgxMjEyMTAwODBkNmY1Mzc5MTNhMDg0MjQ3ZTUzMWMvbWFpZHhfaW5fbHZfdW5pdmVyc2VwbHVzLmpz",19:"aHR0cHM6Ly9zZ2ltZXJhLmdpdGh1Yi5pby9tYWlfUmF0aW5nQW5hbHl6ZXIvc2NyaXB0c19tYWltYWkvbWFpZHhfaW5fbHZfZmVzdGl2YWwuanM=",20:"aHR0cHM6Ly9zZ2ltZXJhLmdpdGh1Yi5pby9tYWlfUmF0aW5nQW5hbHl6ZXIvc2NyaXB0c19tYWltYWkvbWFpZHhfaW5fbHZfZmVzdGl2YWxwbHVzLmpz"},u=/\bdx\s*:\s*([0-9]+)/,d=/\blv\s*:\s*(\[.+?\])/,f=/\bv\s*:\s*(-?[0-9]+)/,m=/\bn\s*:\s*["'](.+?)['"]\s*[,\}]/,g=/\bnn\s*:\s*["'](.+?)['"]\s*[,\}]/;function h(e){const t=e.match(u),n=e.match(d),a=e.match(f),o=e.match(m),l=e.match(g);if(t&&n&&a&&o){let e=JSON.parse(n[1]);if(e.length>r.DIFFICULTIES.length){const t=e.pop();e[r.DIFFICULTIES.length-1]=t}const s={dx:parseInt(t[1]),lv:e,debut:Math.abs(parseInt(a[1])),name:(0,i.normalizeSongName)(o[1])};return l&&(s.nickname=l[1]),s}}function p(e){return"magicVer"+e}t.loadMagic=function(e){return a(this,void 0,void 0,(function*(){const t=function(e){const t=parseInt(window.localStorage.getItem(l));if(isNaN(t)||Date.now()>t){for(const e of s)window.localStorage.removeItem(e);for(const e of o.RATING_CALCULATOR_SUPPORTED_VERSIONS)window.localStorage.removeItem(p(e));return null}const n=p(e),a=window.localStorage.getItem(n);return console.log(`Found cache: ${n}=${a}`),JSON.parse(a)}(e);if(t)return t;console.log("Magic happening...");const n=yield function(e){return a(this,void 0,void 0,(function*(){const t=c[e]||c[18],n=yield fetch(atob(t));return n.ok?(yield n.text()).split("\n").map(h).filter((e=>null!=e)):[]}))}(e);return n.length&&function(e,t){const n=p(e);window.localStorage.setItem(n,JSON.stringify(t)),window.localStorage.setItem(l,String(Date.now()+864e5)),console.log(`Updated cache for ${n}`)}(e,n),n}))}},6991:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.addLvToSongTitle=t.removeScrollControl=t.getEpochTimeFromText=t.fetchGameVersion=t.fetchPage=void 0;const r=n(8642),o="MaiToolsGameVer",i="MaiToolsGameVerExpire",l=6e4*((new Date).getTimezoneOffset()+540);function s(e){return a(this,void 0,void 0,(function*(){const t=yield fetch(e),n=yield t.text();return(new DOMParser).parseFromString(n,"text/html")}))}t.fetchPage=s,t.fetchGameVersion=function e(t){return a(this,void 0,void 0,(function*(){const n=parseInt(window.localStorage.getItem(i));if(!isNaN(n)&&n>=Date.now()){const e=parseInt(window.localStorage.getItem(o));if(!isNaN(e))return e}const a=t.querySelector("select[name=version] option:last-of-type");if(a instanceof HTMLOptionElement){const e=parseInt(a.value);return window.localStorage.setItem(o,String(e)),window.localStorage.setItem(i,String(Date.now()+864e5)),e}return e(t=yield s("/maimai-mobile/record/musicVersion/"))}))},t.getEpochTimeFromText=function(e){const t=e.match(/(\d+)\/(\d+)\/(\d+) (\d+):(\d+)/);return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5])).getTime()-l},t.removeScrollControl=function(e){let t=e.getElementById("page-top");t&&t.remove(),t=e.getElementById("page-bottom"),t&&t.remove()},t.addLvToSongTitle=function(e,t,n){return a(this,void 0,void 0,(function*(){const a=e.querySelector(".basic_block.break"),o=a.querySelector("img");o&&o.remove();const i=document.createElement("div");i.className="f_r",i.append("Lv "+n),i.style.color=(0,r.getDifficultyTextColor)(t),a.append(i)}))}},6358:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFloat=t.roundFloat=t.sum=t.compareNumber=void 0,t.compareNumber=function(e,t){return e>t?1:e<t?-1:0},t.sum=function(e){let t=0;for(const n of e)t+=n;return t},t.roundFloat=function(e,t,n){return Math[t](e/n)*n},t.formatFloat=function(e,t){return e?e.toFixed(t):"0"}},7991:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcRecommendedLv=t.getFinaleRankTitle=t.getRankTitle=t.getRankByAchievement=t.getRankIndexByAchievement=t.getRankDefinitions=t.SSSPLUS_MIN_ACHIEVEMENT=void 0;const a=n(9268),r=n(6358);t.SSSPLUS_MIN_ACHIEVEMENT=100.5;const o=[{minAchv:100.5,factor:22.4,title:"SSS+"},{minAchv:100,factor:21.6,title:"SSS"},{minAchv:99.5,factor:21.1,title:"SS+"},{minAchv:99,factor:20.8,title:"SS"},{minAchv:98,factor:20.3,title:"S+"},{minAchv:97,factor:20,title:"S"},{minAchv:94,factor:16.8,title:"AAA"},{minAchv:90,factor:15.2,title:"AA"},{minAchv:80,factor:13.6,title:"A"},{minAchv:75,factor:12,title:"BBB"},{minAchv:70,factor:11.2,title:"BB"},{minAchv:60,factor:9.6,title:"B"},{minAchv:50,factor:8,title:"C"}];function i(){return o}function l(e){return o.findIndex((t=>e>=t.minAchv))}function s(e){const t=l(e);return t<0?"D":o[t].title}t.getRankDefinitions=i,t.getRankIndexByAchievement=l,t.getRankByAchievement=function(e){const t=l(e);return t<0?null:i()[t]},t.getRankTitle=s,t.getFinaleRankTitle=function(e){return s(e).replace("SSS+","SSS")},t.calcRecommendedLv=function(e,t){const n=(0,r.roundFloat)(100*e/t.factor/t.minAchv,"ceil",.1);return n>a.MAX_LEVEL?-1:n}},6689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRemovedSongs=void 0,t.getRemovedSongs=function(e){return"https://maimaidx.jp"===e?["全世界共通リズム感テスト"]:"https://maimaidx-eng.com"===e?["コネクト","シュガーソングとビターステップ","Mr. Wonderland","ワンダーラスト","LOSER","U.S.A.","新宝島","アウトサイダー","ジャガーノート"]:[]}},4313:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMaiToolsBaseUrl=t.getScriptHost=void 0;const a=n(6162),r="https://myjian.github.io/mai-tools";t.getScriptHost=function(e){const t=Array.from(document.querySelectorAll("script"));for(;t.length;){const n=t.pop();if(n.src.includes(e)){const e=new URL(n.src),t=e.pathname;return e.origin+t.substring(0,t.lastIndexOf("/scripts"))}}return r},t.getMaiToolsBaseUrl=function(){return(0,a.isMaimaiNetOrigin)(window.location.origin)?r:window.location.pathname.startsWith("/mai-tools")?window.location.origin+"/mai-tools":window.location.origin}},472:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isNiconicoLinkImg=t.isNiconicoLink=t.getSongNickname=t.getSongIdx=t.normalizeSongName=t.RATING_TARGET_SONG_NAME_PREFIX=t.DX_SONG_NAME_SUFFIX=void 0;const r=n(6420);t.DX_SONG_NAME_SUFFIX=" [DX]",t.RATING_TARGET_SONG_NAME_PREFIX="▶ ",t.normalizeSongName=function(e){return"D✪N’T  ST✪P  R✪CKIN’"===e?"D✪N’T ST✪P R✪CKIN’":e.replace(/" \+ '/g,"").replace(/' \+ "/g,"")},t.getSongIdx=function(e){return e.getElementsByTagName("form")[0].elements.namedItem("idx").value},t.getSongNickname=function(e,n,a){return"Link"===e&&(e=n.includes("niconico")?"Link(nico)":"Link(org)"),1===a?e+t.DX_SONG_NAME_SUFFIX:e};let o={};t.isNiconicoLink=function(e){return a(this,void 0,void 0,(function*(){if(o.nico===e)return!0;if(o.original===e)return!1;const t=(yield(0,r.fetchSongDetailPage)(e)).body.querySelector(".m_10.m_t_5.t_r.f_12").innerText.includes("niconico");return console.log("Link (idx: "+e+") "+(t?"is niconico":"is original")),t?o.nico=e:o.original=e,t}))},t.isNiconicoLinkImg=function(e){return e.includes("e90f79d9dcff84df")}},87:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.filterSongsByVersion=t.loadSongDatabase=t.SongDatabase=void 0;const r=n(134),o=n(6685),i=n(6689),l=n(4313),s=n(472);class c{constructor(e=!0){this.dxMap=new Map,this.standardMap=new Map,this.verbose=!0,this.verbose=e}insertOrUpdateSong(e,t){const n=1===e.dx?this.dxMap:this.standardMap;if(this.updateSong(e))return;e.debut||0===e.debut||(e.debut=t);const a="Link"===e.name?e.nickname:e.name;if(n.has(a))return console.warn(`Found existing song properties for ${a} ${e.dx}: ${JSON.stringify(n.get(a))}`),void console.warn(`Will ignore ${e}`);n.set(a,e)}updateSong(e){const t=1===e.dx?this.dxMap:this.standardMap,n=t.has(e.name)?e.name:e.nickname,a=t.get(n);if(!a)return!1;let r=a.lv;return e.lv instanceof Array&&(r=a.lv.map(((t,n)=>{const a=e.lv[n];return!isNaN(a)&&a>0?a:t}))),t.set(n,Object.assign(Object.assign(Object.assign({},a),e),{lv:r})),!0}deleteSong(e){this.dxMap.delete(e),this.standardMap.delete(e)}validate(){for(const e of[this.dxMap,this.standardMap])e.forEach((e=>{console.assert(null!=e.debut),console.assert(e.debut>=0&&e.debut<=r.LATEST_VERSION),console.assert(e.lv.length>=4)}))}hasDualCharts(e,t){if("Link"===e)return!0;if(this.dxMap.has(e)&&this.standardMap.has(e))return!0;const n=(0,s.getSongNickname)(e,t,0);return!!n&&this.dxMap.has(n)&&this.standardMap.has(n)}getSongProperties(e,t,n=0){if(null==e)return;const a=1===n?this.dxMap:this.standardMap;let r=a.get(e);if(r)return r;const o=(0,s.getSongNickname)(e,t,0);if(r=a.get(o),r)return r;this.verbose&&console.warn(`Could not find song properties for ${e} ${n}`)}getSongsByVersion(e){const t=[];return this.dxMap.forEach((n=>{n.debut===e&&t.push(n)})),this.standardMap.forEach((n=>{n.debut===e&&t.push(n)})),t}toString(){return String({dxMap:this.dxMap,standardMap:this.standardMap})}}function u(e){return a(this,void 0,void 0,(function*(){let t="";try{const n=yield fetch(e);return n.ok?(t=yield n.text(),JSON.parse(t)):{}}catch(e){console.warn(e),console.warn("Failed to parse JSON: "+t)}return{}}))}t.SongDatabase=c,t.loadSongDatabase=function(e,t){return a(this,void 0,void 0,(function*(){const n=yield(0,o.loadMagic)(e),r=new c;for(const t of n)r.insertOrUpdateSong(t,e);const s=yield function(e){return a(this,void 0,void 0,(function*(){const t=(0,l.getMaiToolsBaseUrl)()+`/data/chart-levels/version${e}.json`,n=yield u(t),a=[];return["standard","dx"].forEach(((e,t)=>{if(n[e])for(const r of Object.keys(n[e]))a.push({name:r,dx:t,lv:n[e][r]})})),a}))}(e);console.log("chartLevelOverrides",s);for(const t of s)r.insertOrUpdateSong(t,e);if("https://maimaidx-eng.com"===t){const e=yield function(){return a(this,void 0,void 0,(function*(){const e=(0,l.getMaiToolsBaseUrl)()+"/data/song-info/intl.json",t=yield u(e),n=[];return["standard","dx"].forEach(((e,a)=>{if(t[e])for(const r of Object.keys(t[e])){const o=t[e][r],i=parseInt(r);for(const e of o)n.push({name:e,dx:a,debut:i})}})),n}))}();console.log("debutVersionOverrides",e);for(const t of e)r.updateSong(t)}const d=(0,i.getRemovedSongs)(t);for(const e of d)r.deleteSong(e);return r.validate(),r}))},t.filterSongsByVersion=function(e,t,n,a){const r=[];for(const o of e){const e=t.getSongProperties(o.name,"",o.dx)||t.getSongProperties(o.nickname,"",o.dx);e?(0===a&&e.debut===n||1===a&&e.debut<n)&&r.push(e):console.warn("Could not find song properties for",o)}return r}},5990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveUserPreference=t.loadUserPreference=void 0,t.loadUserPreference=function(e){return window.localStorage.getItem(e)},t.saveUserPreference=function(e,t){window.localStorage.setItem(e,t)}},6420:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getPostMessageFunc=t.fetchSongDetailPage=t.fetchNewSongs=t.fetchAllSongs=t.handleError=t.ALLOWED_ORIGINS=void 0;const r=n(9099),o=n(2347),i=n(6510),l=n(6991),s=n(472);function c(e){return a(this,void 0,void 0,(function*(){const t=Array.from(e.querySelectorAll(".w_450.m_15.f_0")),n=[];for(const e of t){const t=(0,s.getSongIdx)(e),a=(0,o.getSongName)(e),i=(0,r.getChartType)(e);let l;"Link"===a&&(l=(yield(0,s.isNiconicoLink)(t))?"Link(nico)":"Link(org)"),n.push({dx:i,name:a,nickname:l})}return n}))}t.ALLOWED_ORIGINS=["https://cdpn.io","https://myjian.github.io","http://localhost:8080"],t.handleError=function(e){alert(e)},t.fetchAllSongs=function(e){return a(this,void 0,void 0,(function*(){if(!e){const t=i.SELF_SCORE_URLS.get(1);e=yield(0,l.fetchPage)(t)}return yield c(e)}))},t.fetchNewSongs=function(e){return a(this,void 0,void 0,(function*(){const t=yield(0,l.fetchPage)(`/maimai-mobile/record/musicVersion/search/?version=${e}&diff=0`);return yield c(t)}))},t.fetchSongDetailPage=function(e){return a(this,void 0,void 0,(function*(){const t=new URLSearchParams({idx:e}).toString();return(0,l.fetchPage)("/maimai-mobile/record/musicDetail/?"+t)}))},t.getPostMessageFunc=function(e,t){return(n,a)=>{const r={action:n,payload:a};e.postMessage(r,t)}}},7627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getZhWikiLink=void 0,t.getZhWikiLink=function(e){return"https://maimai.fandom.com/zh/wiki/"+encodeURIComponent(e)+"?variant=zh-hant"}},3324:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNotPlayedCharts=t.getCandidateCharts=void 0;const a=n(5666),r=n(8642),o=n(7991),i=n(472),l=n(7284),s=n(8505);function c(e,t,n){let a=(0,o.getRankIndexByAchievement)(e.achievement);-1===a&&(a=(0,o.getRankIndexByAchievement)(94));const r=(0,o.getRankDefinitions)(),i=new Map;for(let o=a-1;o>=0;o--){const a=r[o];if(a.title===r[o+1].title)continue;const[s]=(0,l.calculateRatingRange)(e.level,a);if(s>t&&(i.set(a.title,{minRt:s-t,rank:a}),i.size>=n))break}return i}t.getCandidateCharts=function(e,t,n){const a=[];if(t<=0)return a;for(let n=0;n<t;n++){const t=e[n];if(t.achievement<o.SSSPLUS_MIN_ACHIEVEMENT){const e=c(t,Math.floor(t.rating),2);if(!e.size)continue;t.nextRanks=e,a.push(t)}}const r=Math.floor(e[t-1].rating);for(let i=t;i<e.length;i++){const t=e[i];if(t.achievement<o.SSSPLUS_MIN_ACHIEVEMENT){const e=c(t,r,2);if(!e.size)continue;if(t.nextRanks=e,a.push(t),a.length>=n)break}}return a.sort(s.compareCandidate),a},t.getNotPlayedCharts=function(e,t,n,l){const u=new Set;for(const e of t){const t=(0,i.getSongNickname)(e.songName,e.genre,e.chartType);u.add(t+e.difficulty)}const d=t.length?Math.ceil(t[0].rating):0,f=t.length?Math.floor(t[n-1].rating):0,m=(0,o.getRankByAchievement)(100.5),g=(0,o.getRankByAchievement)(97),h=d?100*d/(g.factor*g.minAchv):15,p=100*f/(m.factor*m.minAchv),v=[],_=(0,a.shuffleArray)(e);for(const e of _){for(let t=1;t<e.lv.length;t++){let n=e.lv[t];const a=n>0;n=Math.abs(n);const o="Link"===e.name?e.nickname:(0,i.getSongNickname)(e.name,"",e.dx),l=r.DIFFICULTIES[Math.min(t,r.DIFFICULTIES.length-1)];if(u.has(o+l)||n<p||n>h)continue;const s={songName:e.name,difficulty:l,level:n,levelIsPrecise:a,genre:"",chartType:e.dx,rating:0,achievement:0},d=c(s,f,1);d.size&&(s.nextRanks=d,v.push(s))}if(v.length>=l)break}return v.sort(s.compareSongsByLevel),v}},8906:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommonMessages=void 0,t.CommonMessages={en_US:{subtotal:"Subtotal",difficulty:"Difficulty",level:"Level"},zh_TW:{subtotal:"小計",difficulty:"難度",level:"等級"},ko_KR:{subtotal:"총합",difficulty:"난이도",level:"레벨"}}},6741:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CandidateChartRecords=void 0;const i=o(n(7363)),l=n(5215),s=n(8505),c=n(4945),u=n(4961),d=n(7340),f={en_US:{showMore:"Show more",showLess:"Show less"},zh_TW:{showMore:"顯示更多",showLess:"顯示較少"},ko_KR:{showMore:"자세히 보기",showLess:"간략히"}},m=[0,1,2,3,4,6,8],g=new Map([[1,s.compareSongsByName],[2,s.compareSongsByDifficulty],[3,s.compareSongsByLevel],[4,s.compareSongsByAchv],[6,s.compareSongsByNextRank],[8,s.compareSongsByNextRating]]);t.CandidateChartRecords=({hidden:e,played:t,notPlayed:n,songDatabase:a,name:r})=>{const[o,s]=(0,i.useState)(!0),[h,p]=(0,i.useState)(!1),[v,_]=(0,i.useState)(),[y,b]=(0,i.useState)(),S=(0,i.useCallback)((e=>{e.preventDefault(),p(!h)}),[h]),C=(0,i.useCallback)((e=>{s(e)}),[o]),R=(0,i.useCallback)((e=>{g.has(e)?e===v?b(!y):(_(e),b(!1)):_(void 0)}),[v,y]),x=!o&&n?n:t,w=h?x.length:Math.min(x.length,20),E=x.slice(0,w).map(((e,t)=>(e.order=t+1,e)));v&&(E.sort(g.get(v)),y&&E.reverse());const M=x.length>20,N=f[(0,l.useLanguage)()];return i.default.createElement(d.CollapsibleContainer,{className:"songRecordTableContainer",hidden:e},n&&i.default.createElement(c.CandidatesPlayedToggle,{name:r,showPlayed:o,toggleShowPlayed:C}),i.default.createElement(u.ChartRecordsTable,{songDatabase:a,tableClassname:"candidateTable",records:E,sortBy:R,columns:m,isCandidate:!0}),M&&i.default.createElement("a",{className:"showMore",href:"#",onClick:S},h?N.showLess:N.showMore))}},4945:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CandidatesPlayedToggle=void 0;const i=o(n(7363)),l=n(5215),s={en_US:{showPlayed:"Show played charts",showNotPlayed:"Show not yet played charts"},zh_TW:{showPlayed:"顯示已玩過的譜面",showNotPlayed:"顯示未玩過的譜面"},ko_KR:{showPlayed:"플레이한 채보 보기",showNotPlayed:"플레이 한 적 없는 채보 보기"}};t.CandidatesPlayedToggle=({name:e,showPlayed:t,toggleShowPlayed:n})=>{const a=(0,i.useCallback)((()=>{n(!t)}),[n]),r=s[(0,l.useLanguage)()];return i.default.createElement("div",{className:"w90"},i.default.createElement("form",{className:"playedToggleForm"},i.default.createElement("label",{className:"radioLabel"},i.default.createElement("input",{className:"radioInput",name:`showPlayed-${e}`,value:"1",type:"radio",checked:t,onChange:a}),r.showPlayed),i.default.createElement("label",{className:"radioLabel"},i.default.createElement("input",{className:"radioInput",name:`showPlayed-${e}`,value:"0",type:"radio",checked:!t,onChange:a}),r.showNotPlayed)))}},6015:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartRecordDataRow=void 0;const r=a(n(7363)),o=n(8642),i=n(9268),l=n(7991),s=n(472),c=n(471);t.ChartRecordDataRow=r.default.memo((e=>{const{record:t,index:n,columns:a,songDatabase:u,isCandidate:d}=e,f=a.map((e=>{switch(e){case 0:return n;case 1:return function(e,t,n){const a=n&&e.isTarget?s.RATING_TARGET_SONG_NAME_PREFIX:"";return t.hasDualCharts(e.songName,e.genre)?a+(0,s.getSongNickname)(e.songName,e.genre,e.chartType):a+e.songName}(t,u,d);case 2:return(0,o.getDifficultyName)(t.difficulty);case 3:return(0,i.getDisplayLv)(t.level,!t.levelIsPrecise);case 4:return t.achievement.toFixed(4)+"%";case 5:return(0,l.getRankTitle)(t.achievement);case 6:return t.nextRanks?Array.from(t.nextRanks.values()).map((e=>e.rank.minAchv+"%")).join("\n"):"";case 8:return t.nextRanks?Array.from(t.nextRanks.values()).map((e=>"+"+e.minRt.toFixed(0))).join("\n"):"";case 7:return Math.floor(t.rating).toString()}}));return r.default.createElement(c.ChartRecordRow,{className:o.DIFFICULTY_CLASSNAME_MAP.get(t.difficulty),columnValues:f})}))},3401:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartRecordHeadRow=void 0;const r=a(n(7363)),o=n(5215),i=n(8906),l=n(471),s={en_US:{num:"#",song:"Song",level:"Level",rating:"Rating",nextGoal:"Next Goal",nextRating:"+Rating",rank:"Rank",achievementAbbr:"Achv"},zh_TW:{num:"#",song:"歌曲",level:"等級",rating:"R 值",nextGoal:"下個\n目標",nextRating:"R 值\n加分",rank:"Rank",achievementAbbr:"達成率"},ko_KR:{num:"#",song:"노래",level:"레벨",rating:"레이팅",nextGoal:"다음 목표",nextRating:"+레이팅",rank:"등급",achievementAbbr:"정확도"}};t.ChartRecordHeadRow=r.default.memo((({columns:e,sortBy:t})=>{const n=(0,o.useLanguage)(),a=e.map((e=>function(e,t){const n=s[e];return{0:n.num,1:n.song,2:i.CommonMessages[e].difficulty,3:i.CommonMessages[e].level,4:n.achievementAbbr,5:n.rank,7:n.rating,6:n.nextGoal,8:n.nextRating}[t]}(n,e))),c=t&&(n=>t(e[n]));return r.default.createElement(l.ChartRecordRow,{columnValues:a,onClickCell:c,isHeading:!0})}))},471:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartRecordRow=void 0;const r=a(n(7363)),o=n(472),i=n(7627),l=["orderCell","songTitleCell","difficultyCell","levelCell","achievementCell","rankCell","ratingCell"];class s extends r.default.PureComponent{constructor(){super(...arguments),this.getChildren=(e,t,n)=>{if(!n&&1===t){let t=e;const n=t.startsWith(o.RATING_TARGET_SONG_NAME_PREFIX)?o.RATING_TARGET_SONG_NAME_PREFIX.length:0,a=t.endsWith(o.DX_SONG_NAME_SUFFIX)?t.length-o.DX_SONG_NAME_SUFFIX.length:t.length;return t=t.substring(n,a),r.default.createElement("a",{className:"songWikiLink",href:(0,i.getZhWikiLink)(t),target:"_blank"},e)}return"string"==typeof e&&e.includes("\n")?e.split("\n").map(((e,t)=>r.default.createElement("div",{key:t},e))):e}}render(){const{columnValues:e,isHeading:t,onClickCell:n}=this.props;let a="scoreRecordRow";return this.props.className&&(a+=" "+this.props.className),r.default.createElement("tr",{className:a},e.map(((e,a)=>{let o="scoreRecordCell "+l[a];const i=this.getChildren(e,a,t),s=n?{tabIndex:0,onClick:()=>n(a),onKeyDown:e=>{"Enter"===e.key&&n(a)}}:{};return t?r.default.createElement("th",Object.assign({key:a,className:o},s),i):r.default.createElement("td",Object.assign({key:a,className:o},s),i)})))}}t.ChartRecordRow=s},191:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartRecordSectionTitle=void 0;const r=a(n(7363));class o extends r.default.PureComponent{constructor(){super(...arguments),this.state={symbolClassName:""},this.handleClick=e=>{e.preventDefault(),this.props.onClick(e)},this.handleKeyPress=e=>{e.preventDefault(),console.log(e.key),console.log(e.keyCode),"Enter"===e.key&&this.props.onClick(e)}}componentDidUpdate(e){e.contentHidden&&!this.props.contentHidden&&(this.setState({symbolClassName:"crSecShow"}),window.setTimeout((()=>{this.setState({symbolClassName:""})}),300))}render(){const{isCandidateList:e,contentHidden:t,title:n}=this.props;let{symbolClassName:a}=this.state;const o=e?"▷":"▶";return a+=" crSecTitleSymbol",t&&(a+=" crSecHidden"),r.default.createElement("h3",{className:"crSecTitleContainer"},r.default.createElement("span",{className:"crSecTitle",tabIndex:0,onClick:this.handleClick,onKeyPress:this.handleKeyPress},r.default.createElement("span",{className:a},o),n))}}t.ChartRecordSectionTitle=o},4961:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChartRecordsTable=void 0;const r=a(n(7363)),o=n(6015),i=n(3401);class l extends r.default.PureComponent{render(){const{columns:e,sortBy:t,records:n,songDatabase:a,isCandidate:l}=this.props;let{tableClassname:s}=this.props;return s+=" songRecordTable",r.default.createElement("table",{className:s},r.default.createElement("thead",null,r.default.createElement(i.ChartRecordHeadRow,{sortBy:t,columns:e})),r.default.createElement("tbody",null,n.map(((t,n)=>(n=t.order||n+1,r.default.createElement(o.ChartRecordDataRow,{songDatabase:a,record:t,columns:e,key:n,index:n,isCandidate:l}))))))}}t.ChartRecordsTable=l},7340:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsibleContainer=void 0;const r=a(n(7363));class o extends r.default.PureComponent{render(){let e="collapsibleContainer";return this.props.className&&(e+=" "+this.props.className),this.props.hidden&&(e+=" hidden"),r.default.createElement("div",{className:e},this.props.children)}}t.CollapsibleContainer=o},2186:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DifficultyDistribution=void 0;const r=a(n(7363)),o=n(9099),i=n(8642),l=n(5215),s=n(8906),c=n(6025),u=n(614),d="diffRankCell";t.DifficultyDistribution=({chartRecords:e,topChartsCount:t})=>{const n=(0,l.useLanguage)(),a=function(e){const t=new Map;for(let e=i.DIFFICULTIES.length-1;e>=0;e--)t.set(i.DIFFICULTIES[e],{1:0,0:0});for(const n of e)t.get(n.difficulty)[n.chartType]+=1;return t}(e.slice(0,t)),f=new Map([[s.CommonMessages[n].subtotal,!0]]),m=[];return a.forEach(((e,t)=>{for(const a of[1,0]){if(!e[a])continue;const l=new Map([[s.CommonMessages[n].subtotal,e[a]]]);m.push(r.default.createElement(c.RankDistributionDataRow,{key:""+t+a,rowHead:`${(0,i.getDifficultyName)(t)} (${(0,o.getChartTypeName)(a)})`,columns:f.keys(),rankDist:l,rowClassname:i.DIFFICULTY_CLASSNAME_MAP.get(t),baseCellClassname:d,perColumnClassnames:[]}))}})),r.default.createElement("table",{className:"rankDistributionTable"},r.default.createElement("thead",null,r.default.createElement(u.RankDistributionHeadRow,{firstCell:s.CommonMessages[n].difficulty,baseCellClassname:d,perColumnClassnames:["difficultyRankDistHead"],columns:f.keys()})),r.default.createElement("tbody",null,m))}},8169:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageChooser=void 0;const i=o(n(7363)),l=n(8080),s={zh_TW:"繁體中文",en_US:"English",ko_KR:"한국어"};t.LanguageChooser=({activeLanguage:e,changeLanguage:t})=>{const n=(0,i.useCallback)((e=>{t(e.currentTarget.value)}),[t]);return i.default.createElement("tr",null,i.default.createElement("td",null,i.default.createElement("label",{htmlFor:"languageSelect"},"🌐 介面語言 (Language)：")),i.default.createElement("td",null,i.default.createElement("select",{id:"languageSelect",onChange:n,value:e},l.SUPPORTED_LANGUAGES.map((e=>{const t=s[e];return i.default.createElement("option",{key:e,value:e},t)})))))}},7247:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LevelRankDistribution=void 0;const r=a(n(7363)),o=n(9268),i=n(6358),l=n(2060),s=n(6025),c=n(614),u="levelRankCell",d=["officialLevelCell"];class f extends r.default.PureComponent{render(){const{chartRecords:e,topLeftCell:t,topChartsCount:n}=this.props,a=e.slice(0,n),f=(0,l.getRankMap)(a),m=function(e){const t=e.map((e=>e.level));t.sort(i.compareNumber),t.reverse();const n=new Map;for(const e of t){const t=(0,o.getOfficialLevel)(e);n.has(t)||n.set(t,[])}for(const t of e)n.get((0,o.getOfficialLevel)(t.level)).push(t);return n}(a);return r.default.createElement("table",{className:"rankDistributionTable"},r.default.createElement("thead",null,r.default.createElement(c.RankDistributionHeadRow,{columns:f.keys(),firstCell:t,baseCellClassname:u,perColumnClassnames:d})),r.default.createElement("tbody",null,Array.from(m.entries()).map((([e,t])=>r.default.createElement(s.RankDistributionDataRow,{key:e,rowHead:e,columns:f.keys(),rankDist:(0,l.getRankDistribution)(t),baseCellClassname:u,perColumnClassnames:d})))))}}t.LevelRankDistribution=f},6014:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OtherTools=void 0;const r=a(n(7363)),o=n(8190),i=n(5215),l={en_US:{otherToolsHeading:"Other Tools",ratingVisualizer:"Rating Lookup Table & Visualization",bookmarketList:"maimai Bookmarklets (Features & How to use)",arcadeSongs:"arcade-songs (Song searching tool) by Raku Zeta",otohime:"Otohime (Personal score tracking) by KOINU",mapDistanceCalc:"Map Distance Calculator (How many credits to a character/collection item) by 魚丸◎蕾娜"},zh_TW:{otherToolsHeading:"其他工具",ratingVisualizer:"單曲 R 值圖表",bookmarketList:"書籤小工具介紹與設定教學",arcadeSongs:"音樂遊戲歌曲搜尋工具 arcade-songs (由 Raku Zeta 製作)",otohime:"Otohime - 音 Game 成績單網站 (由 KOINU 製作)",mapDistanceCalc:"ちほー道數計算器 (旅伴 & 收藏品) (由 魚丸◎蕾娜 製作)"},ko_KR:{otherToolsHeading:"다른 도구",ratingVisualizer:"레이팅 상수 표 & 시각화",bookmarketList:"maimai 북마크 (기능 & 사용법)",arcadeSongs:"arcade-songs (노래 검색기) by Raku Zeta",otohime:"Otohime - (개인 레이팅 추적기) by KOINU",mapDistanceCalc:"지방 거리 계산기 (특정 캐릭터, 아이템 소장을 위해서 몇 코인 더 부어야 하는지) by 魚丸◎蕾娜"}};t.OtherTools=({gameVer:e})=>{const t=l[(0,i.useLanguage)()],n=`../rating-visualizer/?gameVer=${e}`;return r.default.createElement("div",{className:"otherToolsContainer"},r.default.createElement("hr",{className:"sectionSep"}),r.default.createElement("h2",{className:"otherToolsHeading"},t.otherToolsHeading),r.default.createElement("ul",null,r.default.createElement("li",{className:"toolItem"},r.default.createElement("a",{href:n,target:"_blank"},t.ratingVisualizer)),r.default.createElement("li",{className:"toolItem"},r.default.createElement("a",{href:"..",target:"_blank"},t.bookmarketList)),r.default.createElement("li",{className:"toolItem"},r.default.createElement("a",{href:o.MAIMAI_SONGS_HOME,target:"_blank"},t.arcadeSongs)),r.default.createElement("li",{className:"toolItem"},r.default.createElement("a",{href:"https://otohi.me/",target:"_blank"},t.otohime)),r.default.createElement("li",{className:"toolItem"},r.default.createElement("a",{href:"https://renawevin.weebly.com/rw-maimaidxsplash-chiho-calculate.html",target:"_blank"},t.mapDistanceCalc))))}},3462:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageFooter=void 0;const r=a(n(7363));class o extends r.default.PureComponent{render(){return r.default.createElement("footer",null,"Made by"," ",r.default.createElement("a",{className:"authorLink",href:"https://github.com/myjian/"},"myjian"),".")}}t.PageFooter=o},6025:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RankDistributionDataRow=void 0;const r=a(n(7363)),o=n(5950);t.RankDistributionDataRow=r.default.memo((e=>{const t=[e.rowHead];for(const n of e.columns){const a=e.rankDist.get(n);t.push(a||"-")}return r.default.createElement(o.RankDistributionRow,{values:t,rowClassname:e.rowClassname,baseCellClassname:e.baseCellClassname,perColumnClassnames:e.perColumnClassnames})}))},614:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RankDistributionHeadRow=void 0;const r=a(n(7363)),o=n(5950);t.RankDistributionHeadRow=({firstCell:e,columns:t,baseCellClassname:n,perColumnClassnames:a})=>{const i=[e];for(const e of t)i.push(e);return r.default.createElement(o.RankDistributionRow,{values:i,isHeading:!0,baseCellClassname:n,perColumnClassnames:a})}},5950:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RankDistributionRow=void 0;const r=a(n(7363));class o extends r.default.PureComponent{render(){const{values:e,isHeading:t,rowClassname:n,baseCellClassname:a,perColumnClassnames:o}=this.props;return r.default.createElement("tr",{className:n},e.map(((e,n)=>{const i=t||0===n;let l=a;return o[n]&&(l+=" "+o[n]),i?r.default.createElement("th",{key:n,className:l},e):r.default.createElement("td",{key:n,className:l},e)})))}}t.RankDistributionRow=o},8807:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RatingDetails=void 0;const i=o(n(7363)),l=n(5215),s=n(7258),c=n(6741),u=n(191),d=n(33),f={en_US:{newChartsRatingTargets:"New Charts Rating Subjects (best {count}):",oldChartsRatingTargets:"Old Charts Rating Subjects (best {count}):",newChartsRatingCandidates:"New Charts Rating Candidates:",oldChartsRatingCandidates:"Old Charts Rating Candidates:"},zh_TW:{newChartsRatingTargets:"新譜面 Rating 對象曲 (取最佳 {count} 首)：",oldChartsRatingTargets:"舊譜面 Rating 對象曲 (取最佳 {count} 首)：",newChartsRatingCandidates:"新譜面 Rating 候選曲：",oldChartsRatingCandidates:"舊譜面 Rating 候選曲："},ko_KR:{newChartsRatingTargets:"신곡 레이팅 (최고 기록 {count} 개)：",oldChartsRatingTargets:"구곡 레이팅 (최고 기록 {count} 개)：",newChartsRatingCandidates:"신곡 레이팅 후보：",oldChartsRatingCandidates:"구곡 레이팅 후보："}};t.RatingDetails=({newCandidateCharts:e,notPlayedNewCharts:t,oldCandidateCharts:n,notPlayedOldCharts:a,songDatabase:r,ratingData:o})=>{const[m,g]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[v,_]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1),S=(0,i.useCallback)((()=>{g(!m)}),[m]),C=(0,i.useCallback)((()=>{p(!h)}),[h]),R=(0,i.useCallback)((()=>{_(!v)}),[v]),x=(0,i.useCallback)((()=>{b(!y)}),[y]),{newChartRecords:w,newTopChartsCount:E,oldChartRecords:M,oldTopChartsCount:N}=o,O=f[(0,l.useLanguage)()];return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"songRecordsContainer"},i.default.createElement(u.ChartRecordSectionTitle,{title:O.newChartsRatingTargets.replace("{count}",s.NUM_TOP_NEW_CHARTS.toFixed(0)),contentHidden:m,onClick:S}),i.default.createElement(d.TopChartRecords,{songDatabase:r,records:w,limit:E,hidden:m})),i.default.createElement("div",{className:"songRecordsContainer"},i.default.createElement(u.ChartRecordSectionTitle,{title:O.oldChartsRatingTargets.replace("{count}",s.NUM_TOP_OLD_CHARTS.toFixed(0)),contentHidden:h,onClick:C}),i.default.createElement(d.TopChartRecords,{songDatabase:r,records:M,limit:N,hidden:h})),i.default.createElement("div",{className:"songRecordsContainer"},i.default.createElement(u.ChartRecordSectionTitle,{title:O.newChartsRatingCandidates,contentHidden:v,onClick:R,isCandidateList:!0}),i.default.createElement(c.CandidateChartRecords,{name:"new",songDatabase:r,hidden:v,played:e,notPlayed:t})),i.default.createElement("div",{className:"songRecordsContainer"},i.default.createElement(u.ChartRecordSectionTitle,{title:O.oldChartsRatingCandidates,contentHidden:y,onClick:x,isCandidateList:!0}),i.default.createElement(c.CandidateChartRecords,{name:"old",songDatabase:r,hidden:y,played:n,notPlayed:a})))}},2693:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RatingOutput=void 0;const i=o(n(7363)),l=n(5215),s=n(3324),c=n(7258),u=n(7284),d=n(8807),f=n(3505),m=n(2953),g={en_US:{analysisResult:"Analysis Result"},zh_TW:{analysisResult:"分析結果"},ko_KR:{analysisResult:"분석결과"}};t.RatingOutput=({gameVer:e,newSongs:t,oldSongs:n,ratingData:a,gameRegion:r,playerName:o,songDatabase:h})=>{const p=(0,i.useMemo)((()=>{const{newChartRecords:e,newTopChartsCount:r,oldChartRecords:o,oldTopChartsCount:i}=a,l=(0,s.getCandidateCharts)(e,r,100),d=t?(0,s.getNotPlayedCharts)(t,e,r,100):[];return{newCandidateCharts:l,oldCandidateCharts:(0,s.getCandidateCharts)(o,i,250),notPlayedNewCharts:d,notPlayedOldCharts:n?(0,s.getNotPlayedCharts)(n,o,i,250):[],maxNewChartsRating:t?(0,u.calculateMaxRating)(t,c.NUM_TOP_NEW_CHARTS):0,maxOldChartsRating:n?(0,u.calculateMaxRating)(n,c.NUM_TOP_OLD_CHARTS):0}}),[t,n,a]),v=(0,i.useRef)();(0,i.useEffect)((()=>{v.current&&v.current.scrollIntoView({behavior:"smooth"})}),[]);const{newChartsRating:_,newTopChartsCount:y,oldChartsRating:b,oldTopChartsCount:S}=a,{newCandidateCharts:C,oldCandidateCharts:R,notPlayedNewCharts:x,notPlayedOldCharts:w,maxNewChartsRating:E,maxOldChartsRating:M}=p,N=g[(0,l.useLanguage)()];return i.default.createElement("div",{className:"outputArea",ref:v},i.default.createElement("h2",{id:"outputHeading"},N.analysisResult,o?` - ${o}`:null),i.default.createElement(f.RatingOverview,{newChartsRating:_,newChartsMaxRating:E,newTopChartsCount:y,oldChartsRating:b,oldChartsMaxRating:M,oldTopChartsCount:S,playerGradeIndex:0}),i.default.createElement(m.RecommendedLevels,{gameRegion:r,gameVer:e,newChartsRating:_,newTopChartsCount:y,oldChartsRating:b,oldTopChartsCount:S}),i.default.createElement(d.RatingDetails,{songDatabase:h,newCandidateCharts:C,oldCandidateCharts:R,notPlayedNewCharts:x,notPlayedOldCharts:w,ratingData:a}),i.default.createElement("hr",{className:"sectionSep"}))}},3505:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RatingOverview=void 0;const i=o(n(7363)),l=n(5215),s=n(5945),c={en_US:{average:"Average",column:":",newChartsRating:"New Charts Rating",oldChartsRating:"Old Charts Rating",grade:"Grade"},zh_TW:{average:"平均",column:"：",newChartsRating:"新譜面 Rating",oldChartsRating:"舊譜面 Rating",grade:"段位"},ko_KR:{average:"평균",column:"：",newChartsRating:"신곡 레이팅",oldChartsRating:"구곡 레이팅",grade:"등급"}};function u(e,t){return t?(e/t).toFixed(0):0}t.RatingOverview=({oldChartsRating:e,oldChartsMaxRating:t,oldTopChartsCount:n,newChartsRating:a,newChartsMaxRating:r,newTopChartsCount:o,playerGradeIndex:d})=>{const[f,m]=(0,i.useState)(),g=(0,i.useCallback)((()=>{m(!f)}),[f]),h=c[(0,l.useLanguage)()];let p=a+e;const v=d>0?(0,s.getGradeByIndex)(d):null;return i.default.createElement("div",{className:"ratingOverview"},i.default.createElement("div",{className:"totalRatingRow",tabIndex:0,onClick:g},"Rating："," ",i.default.createElement("span",null,f?`${p} / ${r+t}`:p)),i.default.createElement("table",{className:"ratingOverviewTable"},i.default.createElement("tbody",null,i.default.createElement("tr",null,i.default.createElement("td",null,h.newChartsRating),i.default.createElement("td",{className:"columnColumn"},h.column),i.default.createElement("td",{className:"subRatingColumn"},f?`${a} / ${r}`:a),i.default.createElement("td",{className:"avgRatingColumn"},"(",h.average,h.column," ",u(a,o),")")),i.default.createElement("tr",null,i.default.createElement("td",null,h.oldChartsRating),i.default.createElement("td",null,h.column),i.default.createElement("td",{className:"subRatingColumn"},f?`${e} / ${t}`:e),i.default.createElement("td",{className:"avgRatingColumn"},"(",h.average,h.column," ",u(e,n),")")),v&&i.default.createElement("tr",null,i.default.createElement("td",null,h.grade),i.default.createElement("td",null,h.column),i.default.createElement("td",{className:"subRatingColumn",colSpan:2},v.title)))))}},2953:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedLevels=void 0;const r=a(n(7363)),o=n(6699),i=n(5215),l=n(7991),s={en_US:{recommendedLevels:"Recommended levels",projectedRating:"Potential Rating",newChartsRecLv:"New Charts",oldChartsRecLv:"Old Charts",levelComment:"Note: X.7 and above is classified under X+. For example, 10.7, 10.8, and 10.9 are 10+."},zh_TW:{recommendedLevels:"刷分目標 (推薦等級)",projectedRating:"可獲得 R 值",newChartsRecLv:"新譜面",oldChartsRecLv:"舊譜面",levelComment:"註：X.7 以上是歸類在官方的 X+。舉例來說：10.7, 10.8, 10.9 都算是 10+。"},ko_KR:{recommendedLevels:"추천 레벨",projectedRating:"잠재적 레이팅",newChartsRecLv:"신곡 채보",oldChartsRecLv:"구곡 채보",levelComment:"참고：X.7 이상은 X+로 표시됩니다. 예를 들면 10.7, 10.8, 10.9는 10+입니다."}};t.RecommendedLevels=({gameRegion:e,gameVer:t,newChartsRating:n,newTopChartsCount:a,oldChartsRating:c,oldTopChartsCount:u})=>{const d=s[(0,i.useLanguage)()],f=(0,l.getRankDefinitions)().slice(0,(0,l.getRankIndexByAchievement)(99)+1),m=a>0?Math.floor(n/a):0,g=u>0?Math.floor(c/u):0,h=f.map((e=>(0,l.calcRecommendedLv)(m,e))),p=f.map((e=>(0,l.calcRecommendedLv)(g,e)));return r.default.createElement("div",{className:"recLvSection"},r.default.createElement("h3",{className:"recLvTitle"},d.recommendedLevels),r.default.createElement("table",{className:"recLvTable"},r.default.createElement("thead",null,r.default.createElement("tr",null,r.default.createElement("th",{className:"recLvFirstCol"}),f.map((e=>r.default.createElement("th",{key:e.title},r.default.createElement("span",{className:"recLvRankTitle"},e.title),r.default.createElement("span",{className:"recLvRankAchv"},e.minAchv,"%")))),r.default.createElement("th",null,d.projectedRating))),r.default.createElement("tbody",null,m>0&&r.default.createElement("tr",null,r.default.createElement("th",{className:"recLvFirstCol"},d.newChartsRecLv),h.map(((n,a)=>r.default.createElement(o.RecommendedLevelCell,{key:a,gameRegion:e,gameVer:t,lv:n}))),r.default.createElement("td",null,Math.floor(m),"↑")),g>0&&r.default.createElement("tr",null,r.default.createElement("th",{className:"recLvFirstCol"},d.oldChartsRecLv),p.map(((n,a)=>r.default.createElement(o.RecommendedLevelCell,{key:a,gameRegion:e,gameVer:t-1,includeOldVersions:!0,lv:n}))),r.default.createElement("td",null,Math.floor(g),"↑")))),r.default.createElement("p",{className:"recLvDesc"},d.levelComment))}},5769:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RegionSelect=void 0;const i=o(n(7363)),l=n(5215),s={en_US:{gameVer:"Game region:",japan:"Japan",international:"International"},zh_TW:{gameVer:"遊戲區域：",japan:"日本",international:"國際"},ko_KR:{gameVer:"게임 지역：",japan:"일본",international:"국제"}};t.RegionSelect=({gameRegion:e,handleRegionSelect:t})=>{const n=(0,i.useCallback)((e=>{const n=e.currentTarget.value;t(n)}),[t]),a=s[(0,l.useLanguage)()];return i.default.createElement("tr",null,i.default.createElement("td",null,i.default.createElement("label",{htmlFor:"regionSelect"},a.gameVer)),i.default.createElement("td",null,i.default.createElement("select",{id:"regionSelect",onChange:n,value:e},i.default.createElement("option",{value:"https://maimaidx.jp"},a.japan),i.default.createElement("option",{value:"https://maimaidx-eng.com"},a.international))))}},9606:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=void 0;const o=r(n(7363)),i=n(6162),l=n(134),s=n(8080),c=n(5215),u=n(87),d=n(7258),f=n(8169),m=n(6014),g=n(3462),h=n(2693),p=n(5769),v=n(9401),_=n(6492),y={en_US:{computeRating:"Calculate Rating"},zh_TW:{computeRating:"計算 Rating 值"},ko_KR:{computeRating:"레이팅 계산하기"}};class b extends o.default.PureComponent{constructor(e){super(e),this.playerGradeIndex=0,this.referrer=document.referrer&&new URL(document.referrer).origin,this.playerScores=[],this.changeLanguage=e=>{this.setState({lang:e}),(0,s.saveLanguage)(e),this.postMessageToOpener({action:"saveLanguage",payload:e})},this.selectVersion=e=>{this.setState({gameVer:e},this.analyzeRating)},this.selectRegion=e=>{this.setState({gameRegion:e},this.analyzeRating)},this.analyzeRating=e=>a(this,void 0,void 0,(function*(){e&&e.preventDefault();const{gameVer:t,gameRegion:n}=this.state;this.songDatabase=yield(0,u.loadSongDatabase)(t,n),console.log("Song database:",this.songDatabase);const a=this.playerScores;if(console.log("Player scores:",a),!a.length)return void this.setState({ratingData:void 0});const r=yield(0,d.analyzePlayerRating)(this.songDatabase,a,t,n);console.log("Rating Data:",r),this.setState({ratingData:r})}));const t=new URLSearchParams(location.search),n=t.get("gameVersion"),r=(0,l.validateGameVersion)(n,l.RATING_CALCULATOR_SUPPORTED_VERSIONS[0],l.RATING_CALCULATOR_SUPPORTED_VERSIONS[l.RATING_CALCULATOR_SUPPORTED_VERSIONS.length-1]),o=t.get("friendIdx"),i=t.get("playerName"),c=(0,s.getInitialLanguage)();S(c),this.state={lang:c,gameRegion:"https://maimaidx.jp",gameVer:r,friendIdx:o,playerName:i,progress:""},window.opener&&this.initWindowCommunication()}componentDidUpdate(e,t){!this.songDatabase||(this.state.oldSongs||this.state.newSongs)&&t.gameVer===this.state.gameVer||this.loadSongLists(this.state.gameVer),this.state.lang!=t.lang&&S(this.state.lang)}render(){const{lang:e,gameRegion:t,gameVer:n,playerName:a,ratingData:r,oldSongs:i,newSongs:l,progress:s}=this.state,u=y[e];return o.default.createElement(c.LangContext.Provider,{value:e},o.default.createElement("table",{className:"inputSelectTable"},o.default.createElement(f.LanguageChooser,{activeLanguage:e,changeLanguage:this.changeLanguage}),o.default.createElement(p.RegionSelect,{gameRegion:t,handleRegionSelect:this.selectRegion}),o.default.createElement(_.VersionSelect,{gameVer:n,handleVersionSelect:this.selectVersion})),o.default.createElement(v.ScoreInput,null),o.default.createElement("div",{className:"actionArea"},o.default.createElement("button",{className:"analyzeRatingBtn",onClick:this.analyzeRating},u.computeRating)),s?o.default.createElement("p",null,s):null,o.default.createElement("hr",{className:"sectionSep"}),r&&o.default.createElement(h.RatingOutput,{gameRegion:t,gameVer:n,songDatabase:this.songDatabase,ratingData:r,playerGradeIndex:this.playerGradeIndex,playerName:a,oldSongs:i,newSongs:l}),o.default.createElement(g.PageFooter,null),o.default.createElement(m.OtherTools,{gameVer:n}))}postMessageToOpener(e){if(window.opener)if(this.referrer)window.opener.postMessage(e,this.referrer);else for(const t of i.MAIMAI_NET_ORIGINS)window.opener.postMessage(e,t)}initWindowCommunication(){window.addEventListener("message",(e=>{if((0,i.isMaimaiNetOrigin)(e.origin)){let t;switch(this.referrer=e.origin,console.log(e.origin,e.data),e.data.action){case"gameVersion":this.setState({gameRegion:(0,i.getGameRegionFromOrigin)(e.origin),gameVer:(0,l.validateGameVersion)(e.data.payload,l.RATING_CALCULATOR_SUPPORTED_VERSIONS[0])});break;case"playerGrade":t=parseInt(e.data.payload),t&&(this.playerGradeIndex=t);break;case"showProgress":this.setState({progress:e.data.payload});break;case"setPlayerScore":this.playerScores=e.data.payload;break;case"calculateRating":this.analyzeRating();break;case"allSongs":this.setState({oldSongs:(0,u.filterSongsByVersion)(e.data.payload,this.songDatabase,this.state.gameVer,1)});break;case"newSongs":e.data.payload.length?this.setState({newSongs:(0,u.filterSongsByVersion)(e.data.payload,this.songDatabase,this.state.gameVer,0)}):this.setState({newSongs:this.songDatabase.getSongsByVersion(this.state.gameVer)})}}}));const{friendIdx:e,lang:t}=this.state;e?this.postMessageToOpener({action:"getFriendRecords",payload:e}):this.postMessageToOpener({action:"ready",payload:t})}loadSongLists(e){this.postMessageToOpener({action:"fetchAllSongs"}),this.postMessageToOpener({action:"fetchNewSongs",payload:e})}}function S(e){switch(e){case"en_US":document.title="maimai DX Rating Analyzer";break;case"zh_TW":document.title="maimai DX R 值分析工具"}}t.RootComponent=b},9401:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScoreInput=void 0;const i=o(n(7363)),l=n(5215),s={en_US:{scoreInputHeading:"Player Scores",scoreInputDescPrefix:'Please use "Analyze Self DX Rating" or "Analyze Friend\'s DX Rating" from ',bookmarketLinkLabel:"maimai bookmarklets",scoreInputDescSuffix:" to import scores."},zh_TW:{scoreInputHeading:"玩家成績輸入",scoreInputDescPrefix:"請用 ",bookmarketLinkLabel:"maimai 書籤小工具",scoreInputDescSuffix:" 中的「分析自己 DX Rating」或「分析好友 DX Rating」帶入資料。"},ko_KR:{scoreInputHeading:"플레이 기록",scoreInputDescPrefix:'아래 칸은 "',bookmarketLinkLabel:"maimai 북마크",scoreInputDescSuffix:'의 "내 디럭스 레이팅 분석하기" 또는 "친구 디럭스 레이팅 분석하기"를 사용해서 채워주세요.'}};t.ScoreInput=()=>{const e=s[(0,l.useLanguage)()],[t,n]=(0,i.useState)(!1);return i.default.createElement("div",{className:"w90"},i.default.createElement("h2",{className:"scoreInputHeading",tabIndex:-1,onClick:()=>{n(!t)}},e.scoreInputHeading),i.default.createElement("div",{className:t?"hidden":""},e.scoreInputDescPrefix,i.default.createElement("a",{href:"../#bookmarklets",target:"_blank"},e.bookmarketLinkLabel),e.scoreInputDescSuffix))}},33:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TopChartRecords=void 0;const i=o(n(7363)),l=n(5215),s=n(8906),c=n(8505),u=n(4961),d=n(7340),f=n(2186),m=n(7247),g=[0,1,2,3,4,5,7],h=new Map([[1,c.compareSongsByName],[2,c.compareSongsByDifficulty],[3,c.compareSongsByLevel],[4,c.compareSongsByAchv],[5,c.compareSongsByAchv],[7,c.compareSongsByRating]]);t.TopChartRecords=({hidden:e,records:t,limit:n,songDatabase:a})=>{const[r,o]=(0,i.useState)(7),[c,p]=(0,i.useState)(!1),v=(0,i.useCallback)((e=>{h.has(e)?e===r?p(!c):(o(e),p(!1)):o(void 0)}),[r,c]);let _=t.slice(0,n);_.forEach(((e,t)=>e.order=t+1)),r&&(_.sort(h.get(r)),c&&_.reverse());const y=(0,l.useLanguage)();return i.default.createElement(d.CollapsibleContainer,{className:"songRecordTableContainer",hidden:e},i.default.createElement("div",{className:"responsiveFlexBox"},i.default.createElement(m.LevelRankDistribution,{topLeftCell:s.CommonMessages[y].level,chartRecords:_,topChartsCount:n}),i.default.createElement(f.DifficultyDistribution,{chartRecords:_,topChartsCount:n})),i.default.createElement(u.ChartRecordsTable,{songDatabase:a,columns:g,tableClassname:"topRecordTable",records:_,sortBy:v}))}},6492:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.VersionSelect=void 0;const i=o(n(7363)),l=n(134),s=n(5215),c={en_US:{gameVer:"Game version:"},zh_TW:{gameVer:"遊戲版本："},ko_KR:{gameVer:"게임 버전："}};t.VersionSelect=({gameVer:e,handleVersionSelect:t})=>{const n=(0,i.useCallback)((e=>{t(parseInt(e.currentTarget.value))}),[t]),a=c[(0,s.useLanguage)()];return i.default.createElement("tr",null,i.default.createElement("td",null,i.default.createElement("label",{htmlFor:"versionSelect"},a.gameVer)),i.default.createElement("td",null,i.default.createElement("select",{id:"versionSelect",onChange:n,value:e},l.RATING_CALCULATOR_SUPPORTED_VERSIONS.map((e=>{const t=e.toFixed(0);return i.default.createElement("option",{key:t,value:t},(0,l.getVersionName)(e))})))))}},5945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGradeByIndex=void 0;const n=[{title:""},{title:"初心者"},{title:"見習い"},{title:"駆け出し"},{title:"修行中"},{title:"初段"},{title:"二段"},{title:"三段"},{title:"四段"},{title:"五段"},{title:"六段"},{title:"七段"},{title:"八段"},{title:"九段"},{title:"十段"},{title:"皆伝"},{title:"壱皆伝"},{title:"弐皆伝"},{title:"参皆伝"},{title:"肆皆伝"},{title:"伍皆伝"},{title:"陸皆伝"},{title:"漆皆伝"},{title:"捌皆伝"},{title:"玖皆伝"},{title:"拾皆伝"}];t.getGradeByIndex=function(e){return n[e]}},5869:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(7363)),o=a(n(745));n(2195),n(5904),n(3662),n(862),n(1444),n(8273),n(2889);const i=n(9606);o.default.createRoot(document.getElementById("root")).render(r.default.createElement(i.RootComponent))},2060:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRankMap=t.getRankDistribution=void 0;const a=n(7991);function r(e){const t=(0,a.getRankDefinitions)(),n=new Map;for(const e of t)n.set(e.title,0);return e.forEach((e=>{const t=(0,a.getRankTitle)(e.achievement),r=n.get(t);n.set(t,r+1)})),n}t.getRankDistribution=r,t.getRankMap=function(e){const t=r(e),n=new Map;let a=e.length;for(const[e,r]of t)a>0&&n.set(e,!0),a-=r;return n}},7258:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function l(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzePlayerRating=t.NUM_TOP_OLD_CHARTS=t.NUM_TOP_NEW_CHARTS=void 0;const r=n(7991),o=n(6689),i=n(8505);function l(e){e=Math.min(e,r.SSSPLUS_MIN_ACHIEVEMENT);const t=(0,r.getRankByAchievement)(e);return t||console.warn(`Could not find rank for achievement ${e.toFixed(4)}%`),(t?t.factor:5)*e/100}function s(e,t){if(t){const n=t.lv[e.difficulty];"number"==typeof n&&(e.levelIsPrecise=n>0,e.level=Math.abs(n))}return Object.assign(Object.assign({},e),{rating:e.level*l(e.achievement)})}t.NUM_TOP_NEW_CHARTS=15,t.NUM_TOP_OLD_CHARTS=35,t.analyzePlayerRating=function(e,n,r,l){return a(this,void 0,void 0,(function*(){const a=[],c=[],u=(0,o.getRemovedSongs)(l);for(const t of n){if(u.includes(t.songName))continue;const n=e.getSongProperties(t.songName,t.genre,t.chartType),o=n?n.debut===r:1===t.chartType,i=s(t,n);o?a.push(i):c.push(i)}a.sort(i.compareSongsByRating),c.sort(i.compareSongsByRating);let d=0;const f=Math.min(t.NUM_TOP_NEW_CHARTS,a.length);for(let e=0;e<f;e++){const t=a[e];t.isTarget=!0,d+=Math.floor(t.rating)}let m=0;const g=Math.min(t.NUM_TOP_OLD_CHARTS,c.length);for(let e=0;e<g;e++){const t=c[e];t.isTarget=!0,m+=Math.floor(t.rating)}return{newChartRecords:a,newChartsRating:d,newTopChartsCount:f,oldChartRecords:c,oldChartsRating:m,oldTopChartsCount:g}}))}},7284:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateMaxRating=t.calculateRatingRange=void 0;const a=n(6358),r=n(7991);t.calculateRatingRange=function(e,t){const n=(0,r.getRankDefinitions)(),a=n.indexOf(t),o=a>=1?n[a-1].minAchv-1e-4:t.minAchv;return[Math.floor(e*t.minAchv*t.factor/100),Math.floor(e*o*t.factor/100)]},t.calculateMaxRating=function(e,t){let n=[];for(const t of e)n=n.concat(t.lv.filter((e=>"number"==typeof e)).map((e=>Math.abs(e))));n.sort(a.compareNumber);const o=n.slice(Math.max(0,n.length-t)),i=(0,r.getRankDefinitions)()[0];let l=0;for(const e of o)l+=Math.floor(e*i.minAchv*i.factor/100);return l}},8505:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compareSongsByDifficulty=t.compareSongsByNextRank=t.compareSongsByName=t.compareSongsByAchv=t.compareSongsByLevel=t.compareSongsByNextRating=t.compareCandidate=t.compareSongsByRating=void 0;const a=n(8642);function r(e,t){return e>t?-1:Number(e<t)}function o(e,t,n){return r(e[n],t[n])}t.compareSongsByRating=function(e,t){return o(e,t,"rating")||o(e,t,"level")||o(e,t,"achievement")},t.compareCandidate=function(e,t){const n=e.nextRanks.values().next().value,a=n.minRt/(n.rank.minAchv-e.achievement),i=t.nextRanks.values().next().value;return r(a,i.minRt/(i.rank.minAchv-t.achievement))||r(n.minRt,i.minRt)||o(e,t,"level")},t.compareSongsByNextRating=function(e,t){const n=e.nextRanks.values().next().value,a=t.nextRanks.values().next().value;return r(n.minRt,a.minRt)||o(e,t,"level")},t.compareSongsByLevel=function(e,t){return o(t,e,"level")},t.compareSongsByAchv=function(e,t){return o(e,t,"achievement")},t.compareSongsByName=function(e,t){return n=t,e["songName"].localeCompare(n.songName);var n},t.compareSongsByNextRank=function(e,t){const n=e.nextRanks.values().next().value.rank,a=t.nextRanks.values().next().value.rank;return r(n.minAchv,a.minAchv)},t.compareSongsByDifficulty=function(e,t){return r(a.DIFFICULTIES.indexOf(e.difficulty),a.DIFFICULTIES.indexOf(t.difficulty))}},7363:e=>{e.exports=React},1533:e=>{e.exports=ReactDOM}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={id:a,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,n(5869)})();