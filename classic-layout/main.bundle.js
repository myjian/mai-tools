(()=>{"use strict";var e={9671:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(8081),a=n.n(r),o=n(3645),i=n.n(o)()(a());i.push([e.id,"body {\r\n  margin: 0;\r\n  padding: 0;\r\n  background-color: #606fb3;\r\n  font-family: 'ヒラギノ角ゴ Pro W3', 'メイリオ', Meiryo, 'ＭＳ Ｐゴシック', 'MS P Gothic',\r\n    sans-serif;\r\n}\r\n\r\nbutton {\r\n  cursor: pointer;\r\n}\r\n\r\nbutton:focus {\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.error {\r\n  color: #ffe9e9;\r\n  text-align: center;\r\n}\r\n\r\n.remaster {\r\n  color: #bd6bd5;\r\n}\r\n\r\n.master {\r\n  color: #916dd2;\r\n}\r\n\r\n.expert {\r\n  color: #bc2141;\r\n}\r\n\r\n.advanced {\r\n  color: #fbb822;\r\n}\r\n\r\n.basic {\r\n  color: #49b63e;\r\n}\r\n\r\n.perfect {\r\n  color: #de8235;\r\n}\r\n\r\n.great {\r\n  color: #e730a4;\r\n}\r\n\r\n.good {\r\n  color: #229337;\r\n}\r\n\r\n.miss {\r\n  color: #6a648a;\r\n}\r\n\r\n.score,\r\n.rowHead {\r\n  color: #254a76;\r\n}\r\n\r\n.nextRank {\r\n  color: #ba32b8;\r\n}\r\n\r\n.maxCombo {\r\n  color: #ed245b;\r\n}\r\n\r\n.maxScore {\r\n  color: #f6a82c;\r\n}\r\n\r\n.widthLimit {\r\n  max-width: 500px;\r\n  min-width: 460px;\r\n  margin: 20px auto;\r\n  padding: 6px;\r\n  border-radius: 18px;\r\n  background-color: #e5b323;\r\n  /*  background-image: url(../maimai-img/bg_star.png); */\r\n  background-size: 540px;\r\n  background-repeat: repeat;\r\n  box-shadow: 0px -2px 5px rgba(0, 0, 0, 0.4), 0px 2px 5px rgba(0, 0, 0, 0.4);\r\n  box-sizing: border-box;\r\n}\r\n\r\n.container {\r\n  background-color: #223641;\r\n  padding: 6px;\r\n  padding-bottom: 10px;\r\n  border-radius: 14px;\r\n}\r\n\r\n.pageTitle {\r\n  font-size: 18px;\r\n  text-align: center;\r\n  margin: 5px 0 0;\r\n  padding: 0;\r\n  padding-bottom: 4px;\r\n  color: white;\r\n  font-weight: normal;\r\n}\r\n\r\n.pageSectionSeparator {\r\n  height: 7px;\r\n  width: 100%;\r\n  background-color: #fad80b;\r\n  margin: 5px 0;\r\n}\r\n\r\n.songScoreContainer {\r\n  width: 100%;\r\n  margin: 11px 0 10px;\r\n  background-color: white;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.dateAndPlace {\r\n  background-color: #0095d7;\r\n  color: white;\r\n  border: 1px solid #dddce0;\r\n  border-bottom-style: none;\r\n  padding: 10px;\r\n  line-height: 24px;\r\n  font-family: serif;\r\n  letter-spacing: 0.3px;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.date,\r\n.place {\r\n  padding: 2px 4px;\r\n}\r\n\r\n.date {\r\n  padding-bottom: 1px;\r\n}\r\n\r\n.place {\r\n  padding-top: 1px;\r\n  border-style: none;\r\n  background: inherit;\r\n  color: inherit;\r\n  font-family: inherit;\r\n  font-size: inherit;\r\n  text-align: left;\r\n}\r\n\r\n.songScoreBody {\r\n  border: 6px solid #dddce0;\r\n  padding: 4px 6px;\r\n}\r\n\r\n.trackTopLine {\r\n  color: #999999;\r\n  box-shadow: 1px 1px 1px #ececec;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.track {\r\n  color: #fd3569;\r\n  font-family: Arial, sans-serif;\r\n  font-weight: bold;\r\n  font-size: 20px;\r\n}\r\n\r\n.songTitle {\r\n  margin: -5px 0 0;\r\n  font-size: 25px;\r\n}\r\n\r\n.songWikiLink {\r\n  color: inherit;\r\n  text-decoration: none;\r\n}\r\n\r\n.songImgContainer {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-top: 2px;\r\n}\r\n\r\n.songImg {\r\n  width: 290px;\r\n  height: 290px;\r\n}\r\n\r\n.songImgPlaceholder {\r\n  --c2: #8995ca;\r\n  --c3: #6c79b3;\r\n  --c1: #a8b2e1;\r\n  --t: 48px;\r\n  --angle: 70deg;\r\n  --grad: var(--c1) var(--t), var(--c1) calc(var(--t) * 2), var(--c2) calc(var(--t) * 2),\r\n    var(--c2) calc(var(--t) * 3), var(--c3) calc(var(--t) * 3), var(--c3) calc(var(--t) * 4);\r\n  background: repeating-linear-gradient(var(--angle), var(--grad)), var(--c1);\r\n  position: relative;\r\n}\r\n\r\n.songImgPlaceholder::after {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  content: '';\r\n  background: repeating-linear-gradient(calc(var(--angle) * -1), var(--grad)), var(--c1);\r\n}\r\n\r\n.songImgReflecContainer {\r\n  position: relative;\r\n  width: 290px;\r\n  margin-top: 3px;\r\n  height: 45px;\r\n  mask-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.4) 40px);\r\n  -webkit-mask-image: linear-gradient(\r\n    to bottom,\r\n    rgba(255, 255, 255, 0),\r\n    rgba(255, 255, 255, 0.4) 40px\r\n  );\r\n  transform: rotateX(180deg);\r\n}\r\n\r\n.songImgReflec {\r\n  height: 100%;\r\n  width: 100%;\r\n  background-repeat: no-repeat;\r\n  background-position: bottom center;\r\n  background-size: 300px;\r\n}\r\n\r\n.songImgReflecPlaceholder {\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.achievementInfo {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: end;\r\n  padding: 0 10px;\r\n  margin-top: 4px;\r\n}\r\n\r\n.achvInfoSpace {\r\n  flex: 100 0 5px;\r\n}\r\n\r\n.rank {\r\n  /* sc = shadow color */\r\n  --c: #ff6509;\r\n}\r\n\r\n.apfc {\r\n  --c: #0a99fd;\r\n}\r\n\r\n.apfc.fcplus {\r\n  --c: #f58223;\r\n}\r\n\r\n.apfc.ap {\r\n  --c: #ff2525;\r\n}\r\n\r\n.sync {\r\n  --c: #1061d0;\r\n}\r\n\r\n.rank,\r\n.apfc,\r\n.sync {\r\n  --sc: rgba(190, 190, 190, 0.685);\r\n  flex: 1 0 52px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n  padding: 0 3px;\r\n  color: var(--c);\r\n  text-shadow: 1px 1px 4px var(--sc);\r\n  /* text-shadow: 0 -1px 2px var(--sc), -1px 0 2px var(--sc), 1px 0 2px var(--sc), 0 1px 2px var(--sc); */\r\n  font-size: 22px;\r\n  font-family: Arial, Helvetica, sans-serif;\r\n  font-weight: 900;\r\n}\r\n\r\n.finaleSync {\r\n  font-weight: bold;\r\n  font-family: unset;\r\n  font-size: 14px;\r\n  line-height: 16px;\r\n}\r\n\r\n.apfc:empty,\r\n.sync:empty {\r\n  display: none;\r\n}\r\n\r\n.rankImg,\r\n.apFcImg,\r\n.syncImg {\r\n  max-width: 45px;\r\n}\r\n\r\n.playerScore {\r\n  flex: 1 1 140px;\r\n  text-align: center;\r\n  padding: 0 2px 0 7px;\r\n  min-height: 54px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: end;\r\n}\r\n\r\n.highScore {\r\n  color: #ea3a69;\r\n  font-size: 17px;\r\n  font-weight: bold;\r\n  padding: 0 8px;\r\n  flex: 2;\r\n  text-align: center;\r\n  position: relative;\r\n  top: 3px;\r\n}\r\n\r\n.achievement {\r\n  font-size: 18px;\r\n  flex: 1 1 22px;\r\n  display: flex;\r\n  padding: 0 8px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  white-space: nowrap;\r\n  padding-top: 2px;\r\n  padding-bottom: 2px;\r\n  position: relative;\r\n  top: 2px;\r\n  border: none;\r\n  background: inherit;\r\n  font-family: inherit;\r\n  font-size: inherit;\r\n}\r\n\r\n.achvNum {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.maxAchv {\r\n  border-top: 1px solid black;\r\n  padding: 0 3px;\r\n}\r\n\r\n.hasMaxAchv {\r\n  font-size: 16px;\r\n  flex-basis: 20px;\r\n}\r\n\r\n.judgementContainer {\r\n  margin: 4px 2px 8px;\r\n}\r\n\r\n.judgement {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  table-layout: fixed;\r\n  font-size: 13px;\r\n}\r\n\r\n.judgement td,\r\n.judgement th {\r\n  border: 2px solid #e5b323;\r\n  vertical-align: middle;\r\n  padding: 1px 2px;\r\n  font-weight: 700;\r\n}\r\n\r\n.rowHead {\r\n  width: 48px;\r\n}\r\n\r\n.score {\r\n  width: 94px;\r\n}\r\n\r\n@media only screen and (max-width: 700px) {\r\n  .judgement td,\r\n  .judgement th {\r\n    padding: 2px 2px;\r\n  }\r\n\r\n  .score {\r\n    width: 90px;\r\n  }\r\n}\r\n\r\nth {\r\n  text-align: center;\r\n}\r\n\r\ntd.perfect,\r\ntd.great,\r\ntd.good,\r\ntd.miss,\r\ntd.score {\r\n  text-align: right;\r\n}\r\n\r\n.breakDistribution {\r\n  display: flex;\r\n}\r\n\r\n.breakDistribution span {\r\n  flex: 3 1 20px;\r\n  text-align: center;\r\n  padding-left: 3px;\r\n  position: relative;\r\n}\r\n\r\n.breakDistribution .perfect,\r\n.breakDistribution .great {\r\n  flex-grow: 1;\r\n}\r\n\r\n.breakNoteRow .miss {\r\n  position: relative;\r\n  text-align: right;\r\n}\r\n\r\n.breakDistribution .perfect:after,\r\n.breakDistribution .great:after,\r\n.missWithBefore:before {\r\n  content: '-';\r\n  position: absolute;\r\n  right: -5px;\r\n  color: #888;\r\n  opacity: 0.3;\r\n}\r\n\r\n.missWithBefore:before {\r\n  position: static;\r\n  padding-right: 26px;\r\n}\r\n\r\n.breakDistribution .good {\r\n  text-align: right;\r\n  padding-right: 1px;\r\n}\r\n\r\n.judgement .noLeftBorder {\r\n  border-left-style: none;\r\n}\r\n\r\n.judgement .noRightBorder {\r\n  border-right-style: none;\r\n}\r\n\r\n.nextRank td,\r\n.maxCombo td {\r\n  text-align: right;\r\n}\r\n\r\n.nextRankTitle {\r\n  padding-right: 18px;\r\n  opacity: 0.5;\r\n}\r\n\r\n.tableSeparator td {\r\n  border-style: none;\r\n  height: 22px;\r\n}\r\n\r\n.pageFooter {\r\n  padding-top: 4px;\r\n  color: #00a4ac;\r\n  text-align: center;\r\n}\r\n\r\n.credit {\r\n  color: #eee;\r\n  text-align: center;\r\n  padding-bottom: 40px;\r\n  margin: 16px 0;\r\n}\r\n\r\n.closePage,\r\n.authorLink {\r\n  color: inherit;\r\n  text-decoration: none;\r\n}\r\n\r\n.closePage:hover,\r\n.authorLink:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.closePage:visited {\r\n  color: inherit;\r\n}\r\n\r\n.authorLink,\r\n.authorLink:visited {\r\n  color: #fff;\r\n}\r\n\r\n.hidden {\r\n  display: none;\r\n}\r\n",""]);const s=i},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},8081:e=>{e.exports=function(e){return e[1]}},9588:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var r=n(3379),a=n.n(r),o=n(7795),i=n.n(o),s=n(569),c=n.n(s),l=n(3565),d=n.n(l),u=n(9216),f=n.n(u),m=n(4589),g=n.n(m),p=n(9671),h={};h.styleTagTransform=g(),h.setAttributes=d(),h.insert=c().bind(null,"head"),h.domAPI=i(),h.insertStyleElement=f(),a()(p.Z,h);const x=p.Z&&p.Z.locals?p.Z.locals:void 0},3379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],s=0;s<e.length;s++){var c=e[s],l=r.base?c[0]+r.base:c[0],d=o[l]||0,u="".concat(l," ").concat(d);o[l]=d+1;var f=n(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(m);else{var g=a(m,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:g,references:1})}i.push(u)}return i}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var s=n(o[i]);t[s].references--}for(var c=r(e,a),l=0;l<o.length;l++){var d=n(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},7980:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAchvLoss=void 0;const r=n(6358),a=n(1782);function o(){return Object.assign({total:0},a.EMPTY_JUDGEMENT_OBJ)}t.calculateAchvLoss=function(e,t,n){const i=o(),s=o(),c={dx:new Map,finale:new Map},l=(0,r.sum)(Object.values(e.get("break")));return e.forEach(((e,r)=>{const d=a.BASE_SCORE_PER_TYPE[r],u=o(),f=o();if("break"===r)u.perfect=50*t.get(2550)+100*t.get(2500),u.great=600*t.get(2e3)+1100*t.get(1500)+1350*t.get(1250),u.good=1600*t.get(1e3),u.miss=2600*t.get(0),u.total=Object.values(u).reduce(((e,t)=>e+t),0),f.perfect=(t.get(2550)*(1-a.BREAK_BONUS_MULTIPLIER.get(2550))+t.get(2500)*(1-a.BREAK_BONUS_MULTIPLIER.get(2500)))/l,f.great=(t.get(2e3)*(1-a.BREAK_BASE_SCORE_MULTIPLIER.get(2e3))+t.get(1500)*(1-a.BREAK_BASE_SCORE_MULTIPLIER.get(1500))+t.get(1250)*(1-a.BREAK_BASE_SCORE_MULTIPLIER.get(1250)))*d/n+(t.get(2e3)*(1-a.BREAK_BONUS_MULTIPLIER.get(2e3))+t.get(1500)*(1-a.BREAK_BONUS_MULTIPLIER.get(1500))+t.get(1250)*(1-a.BREAK_BONUS_MULTIPLIER.get(1250)))/l,f.good=t.get(1e3)*(1-a.BREAK_BASE_SCORE_MULTIPLIER.get(1e3))*d/n+t.get(1e3)*(1-a.BREAK_BONUS_MULTIPLIER.get(1e3))/l,f.miss=t.get(0)*d/n+t.get(0)/l,f.total=Object.values(f).reduce(((e,t)=>e+t),0);else{u.perfect=0,u.great=Math.round(e.great*d*(1-a.REGULAR_BASE_SCORE_MULTIPLIER.great)),u.good=Math.round(e.good*d*(1-a.REGULAR_BASE_SCORE_MULTIPLIER.good)),u.miss=e.miss*d,u.total=Object.values(u).reduce(((e,t)=>e+t),0);for(const[e,t]of Object.entries(u))f[e]=t/n}for(const[e,t]of Object.entries(u))s[e]+=t;for(const[e,t]of Object.entries(f))i[e]+=t;c.finale.set(r,u),c.dx.set(r,f)})),c.finale.set("total",s),c.dx.set("total",i),c}},7616:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.walkBreakDistributions=void 0;const r=n(1782);t.walkBreakDistributions=function e(t,n,a,o,i){let s=a[0],c=!1,l=0;switch(a.length){case 5:return n.set(r.MAX_BREAK_POINTS,s),e(t,n,a.slice(1),o,i);case 4:let d=0,u=s;if(n.has(r.MAX_BREAK_POINTS)){const e=n.get(r.MAX_BREAK_POINTS);s+=e,d=e,u=e}for(let f=u;f>=d;f--){n.set(r.MAX_BREAK_POINTS,f);for(let r=s-f;r>=0;r--){n.set(2550,r),n.set(2500,s-f-r);const d=e(t,n,a.slice(1),o,i);if(c||(l=d,c=!0),d<o)break}}return l;case 3:for(let r=s;r>=0;r--){n.set(2e3,r);for(let d=s-r;d>=0;d--){n.set(1500,d),n.set(1250,s-r-d);const u=e(t,n,a.slice(1),o,i);if(c||(l=u,c=!0),u<o)break}}return l;case 2:return n.set(1e3,s),e(t,n,a.slice(1),o,i);case 1:return n.set(0,s),e(t,n,a.slice(1),o,i);case 0:let f=0,m=0,g=0;return n.forEach(((e,t)=>{f+=e,g+=e*r.BREAK_BASE_SCORE_MULTIPLIER.get(t)*i,m+=e*r.BREAK_BONUS_MULTIPLIER.get(t)})),g+=m/f,o-=g,Math.abs(o)<1e-4&&t.push(new Map(n)),g;default:throw new Error("unreachable")}}},7889:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AchievementInfo=void 0;const a=r(n(7363)),o=n(7991);function i(e,t,n,r){return t?(0,o.getRankTitle)(n):"AP+"===r?"SSS+":(0,o.getFinaleRankTitle)(e)}function s(e){const t="apfc";return e?"FC+"===e?t+" fcplus":e.includes("AP")?t+" ap":t:t}function c(e){return e?"sync":"sync finaleSync"}class l extends a.default.PureComponent{static getDerivedStateFromProps(e){const{dxAchv:t,apFcStatus:n,finaleAchv:r,isDxMode:a}=e;return{rankTitle:i(r,a,t,n)}}componentDidMount(){this.fetchRankImage()}componentDidUpdate(){this.fetchRankImage()}render(){const{apFcStatus:e,apFcImg:t,rankImgMap:n,isHighScore:r,syncStatus:o,syncImg:i,maxFinaleAchv:l,dxAchv:d,finaleAchv:u,isDxMode:f,toggleDisplayMode:m,showMaxAchv:g}=this.props,{rankTitle:p}=this.state,h=n.get(p),x=h?a.default.createElement("img",{className:"rankImg",src:h,alt:p}):p,E=t?a.default.createElement("img",{className:"apFcImg",src:t,alt:e}):e,v=i?a.default.createElement("img",{className:"syncImg",src:i,alt:o}):this.getSyncStatusText(o,f),S=f?d.toFixed(4):u.toFixed(2),_=f?101..toFixed(4):l.toFixed(2);return a.default.createElement("div",{className:"achievementInfo"},a.default.createElement("div",{className:"achvInfoSpace"}),a.default.createElement("div",{className:"rank"},x),a.default.createElement("div",{className:s(e)},E),a.default.createElement("div",{className:c(f)},v),a.default.createElement("div",{className:"playerScore"},a.default.createElement("div",{className:"highScore"},r?"HIGH SCORE!!":" "),a.default.createElement("button",{className:"achievement",onClick:m},"達成率：",a.default.createElement("span",{className:"achvNum"+(g?" hasMaxAchv":"")},a.default.createElement("span",{className:"playerAchv"},S,"％"),g&&a.default.createElement("span",{className:"maxAchv"},_,"％")))))}getSyncStatusText(e,t){if(e&&!t)switch(e){case"FS":case"FS+":return"MAX FEVER";case"FDX":case"FDX+":return"100% SYNC"}return e}fetchRankImage(){const{rankImgMap:e,fetchRankImage:t}=this.props,{rankTitle:n}=this.state;e.has(n)||t(n)}}t.AchievementInfo=l},5188:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BreakNoteJudgement=void 0;const a=r(n(7363)),o=n(3526);class i extends a.default.PureComponent{render(){const{judgements:e,distribution:t,lastColumn:n,isDxMode:r,displayMode:i}=this.props,s=n.isMax?"score maxScore":"score";return"DETAIL"===i?a.default.createElement("tr",{className:"breakNoteRow"},a.default.createElement("th",{className:"rowHead"},"Break"),a.default.createElement("td",{colSpan:3,className:"noRightBorder"},a.default.createElement("div",{className:"breakDistribution"},a.default.createElement("span",{className:"perfect"},t.get(2600)),a.default.createElement("span",{className:"perfect"},t.get(2550)),a.default.createElement("span",{className:"perfect"},t.get(2500)),a.default.createElement("span",{className:"great"},t.get(2e3)),a.default.createElement("span",{className:"great"},t.get(1500)),a.default.createElement("span",{className:"great"},t.get(1250)),a.default.createElement("span",{className:"good"},t.get(1e3)))),a.default.createElement("td",{className:"noLeftBorder"},a.default.createElement("div",{className:"miss missWithBefore"},t.get(0))),a.default.createElement("td",{className:s},(0,o.getLastColumnText)(n.score,r))):a.default.createElement(o.NoteJudgement,{noteType:"break",judgements:e,lastColumn:n,isDxMode:r})}}t.BreakNoteJudgement=i},5748:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CreditInfo=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){return a.default.createElement("div",{className:"credit"},a.default.createElement("span",{className:"madeBy"},"Made by "),a.default.createElement("a",{className:"authorLink",href:"https://github.com/myjian",target:"_blank"},"myjian"),".")}}t.CreditInfo=o},8625:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DateAndPlace=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){const{date:e,isDxMode:t}=this.props,n=t?"DX":"CAFE MiLK";return a.default.createElement("div",{className:"dateAndPlace"},a.default.createElement("div",{className:"date"},e),a.default.createElement("button",{className:"place",onClick:this.props.toggleDxMode},n))}}t.DateAndPlace=o},9256:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JudgementContainer=void 0;const a=r(n(7363)),o=n(5188),i=n(3826),s=n(3526);class c extends a.default.PureComponent{render(){const{nextRank:e,noteJudgements:t,breakDistribution:n,totalJudgements:r,scorePerType:c,combo:l,isDxMode:d,displayMode:u}=this.props;return a.default.createElement("div",{className:"judgementContainer"},a.default.createElement("table",{className:"judgement"},a.default.createElement("tbody",null,a.default.createElement("tr",null,a.default.createElement("th",{className:"rowHead"}," "),a.default.createElement("th",{className:"perfect"},"Perfect"),a.default.createElement("th",{className:"great"},"Great"),a.default.createElement("th",{className:"good"},"Good"),a.default.createElement("th",{className:"miss"},"Miss"),a.default.createElement("th",{className:"score"},"Score")),a.default.createElement(s.NoteJudgement,{noteType:"total",judgements:r,lastColumn:c.get("total"),isDxMode:d}),a.default.createElement(i.NextRankInfo,{nextRank:e,showTitle:"NORMAL"!==u}),l&&a.default.createElement("tr",{className:"maxCombo"},a.default.createElement("th",{className:"noRightBorder",colSpan:4},"MAX COMBO"),a.default.createElement("td",{className:"noLeftBorder",colSpan:2},l)),a.default.createElement("tr",{className:"tableSeparator"},a.default.createElement("td",{colSpan:6})),a.default.createElement(s.NoteJudgement,{noteType:"tap",judgements:t.get("tap"),lastColumn:c.get("tap"),isDxMode:d}),a.default.createElement(s.NoteJudgement,{noteType:"hold",judgements:t.get("hold"),lastColumn:c.get("hold"),isDxMode:d}),a.default.createElement(s.NoteJudgement,{noteType:"slide",judgements:t.get("slide"),lastColumn:c.get("slide"),isDxMode:d}),a.default.createElement(s.NoteJudgement,{noteType:"touch",judgements:t.get("touch"),lastColumn:c.get("touch"),isDxMode:d}),a.default.createElement(o.BreakNoteJudgement,{judgements:t.get("break"),distribution:n,lastColumn:c.get("break"),isDxMode:d,displayMode:u}))))}}t.JudgementContainer=c},3826:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NextRankInfo=void 0;const a=r(n(7363));class o extends a.default.PureComponent{constructor(){super(...arguments),this.state={showTitle:!1}}render(){const{nextRank:e,showTitle:t}=this.props,n=t&&e?e.title:"",r=this.getNextRankDiff();return a.default.createElement("tr",{className:"nextRank"},a.default.createElement("th",{className:"noRightBorder",colSpan:4},"NEXT RANK"),a.default.createElement("td",{className:"noLeftBorder",colSpan:2},n&&a.default.createElement("span",{className:"nextRankTitle"},n),r&&a.default.createElement("span",{className:"nextRankDiff"},r)))}getNextRankDiff(){const{nextRank:e}=this.props;if(!e)return"—————";const{diff:t}=e;return"number"==typeof t?Math.round(t)!==t?t.toFixed(4)+"%":t.toLocaleString("en"):t}}t.NextRankInfo=o},3526:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteJudgement=t.getLastColumnText=void 0;const a=r(n(7363)),o=n(6358);function i(e,t){return"string"==typeof e?e:t?(0,o.formatFloat)(e,4)+"%":e.toLocaleString("en")}t.getLastColumnText=i;class s extends a.default.PureComponent{render(){const{noteType:e,judgements:t,lastColumn:n,isDxMode:r}=this.props;if(!t)return null;const o=e.charAt(0).toUpperCase()+e.substring(1),s=n.isMax?"score maxScore":"score",c=function(e){const t=e.cp;return t?t+e.perfect:e.perfect}(t);return a.default.createElement("tr",{className:e+"NoteRow"},a.default.createElement("th",{className:"rowHead"},o),a.default.createElement("td",{className:"perfect"},c),a.default.createElement("td",{className:"great"},t.great),a.default.createElement("td",{className:"good"},t.good),a.default.createElement("td",{className:"miss"},t.miss),a.default.createElement("td",{className:s},i(n.score,r)))}}t.NoteJudgement=s},6381:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageFooter=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){return a.default.createElement("div",{className:"pageFooter"},a.default.createElement("a",{className:"closePage",href:"javascript:window.close()"},"戻る"))}}t.PageFooter=o},7208:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageTitle=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){return a.default.createElement("h3",{className:"pageTitle"},"プレイ履歴")}}t.PageTitle=o},5268:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=void 0;const a=r(n(7363)),o=n(8642),i=n(6162),s=n(4518),c=n(5748),l=n(6381),d=n(7208),u=n(1542),f=n(1334),m={date:String(Date.now()),track:"TRACK "+(Math.floor(3*Math.random())+1),songTitle:"分からない",achievement:"95.3035%",highScore:Math.random()>.9?"1":"0",noteDetails:"654-96-31-28\n25-0-0-0\n78-0-0-1\n\n37-2-1-0"};function g(e,t){return t=t||2,e.toString().padStart(t,"0")}function p(e,t,n){return e.get(t)||(console.warn('URL does not contain "'+t+'", using default value "'+n+'"'),n)}function h(e,t=m){const n=p(e,"dt",t.date),r=p(e,"tk",t.track),a=p(e,"df"),i=p(e,"st",t.songTitle),c=p(e,"ac",t.achievement),l=p(e,"hs",t.highScore),d=p(e,"cb"),u=p(e,"nd",t.noteDetails),f=p(e,"sc"),h=(0,o.getDifficultyName)(parseInt(a));return{date:(x=new Date(parseInt(n)),x.getFullYear()+"-"+g(x.getMonth()+1)+"-"+g(x.getDate())+" "+g(x.getHours())+":"+g(x.getMinutes())),track:r,songTitle:i,difficulty:h,syncStatus:f,noteJudgements:(0,s.parseJudgements)(u),combo:d&&d.replace("/"," / "),highScore:"1"===l,achievement:parseFloat(c)};var x}class x extends a.default.PureComponent{constructor(e){super(e),this.referrer=document.referrer&&new URL(document.referrer).origin,this.fetchRankImage=e=>{console.log("fetchRankImage "+e),this.state.rankImg.set(e,null),this.sendMessageToOpener({action:"getRankImage",payload:e})},this.handleWindowMessage=e=>{if((0,i.isMaimaiNetOrigin)(e.origin))switch(this.referrer=e.origin,e.data.action){case"songImage":this.setState({songImg:e.data.imgSrc});break;case"apFcImage":this.setState({apFcImg:URL.createObjectURL(e.data.img)});break;case"syncImage":this.setState({syncImg:URL.createObjectURL(e.data.img)});break;case"rankImage":this.setState((t=>{const n=t.rankImg.get(e.data.title);n&&URL.revokeObjectURL(n);const r=new Map(t.rankImg);return r.set(e.data.title,URL.createObjectURL(e.data.img)),{rankImg:r}}));break;default:console.log(e.data)}};const t=new URLSearchParams(location.search);try{this.state=Object.assign(Object.assign({},h(t)),{rankImg:new Map})}catch(e){console.error(e.message),console.error(e.stack),this.state=Object.assign(Object.assign({},h(new URLSearchParams)),{rankImg:new Map,showError:!0})}}componentDidMount(){document.title=this.state.songTitle+" - maimai classic score layout",window.addEventListener("message",this.handleWindowMessage),this.sendMessageToOpener({action:"ready"})}render(){const{achievement:e,combo:t,date:n,difficulty:r,highScore:o,noteJudgements:i,songTitle:s,track:m,songImg:g,apFcImg:p,rankImg:h,syncImg:x,syncStatus:E,showError:v}=this.state;return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"widthLimit"},a.default.createElement("div",{className:"container"},a.default.createElement(d.PageTitle,null),a.default.createElement(f.SectionSep,null),v?a.default.createElement("div",{className:"error"},"Failed to parse input. Please contact the developer!"):a.default.createElement(u.ScorePageContainer,{achievement:e,combo:t,date:n,difficulty:r,highScore:o,noteJudgements:i,songTitle:s,track:m,syncStatus:E,songImgSrc:g,apFcImg:p,rankImg:h,syncImg:x,fetchRankImage:this.fetchRankImage}),a.default.createElement(f.SectionSep,null),a.default.createElement(l.PageFooter,null))),a.default.createElement(c.CreditInfo,null))}sendMessageToOpener(e){if(window.opener)if(console.log("sending message to opener",e),this.referrer)window.opener.postMessage(e,this.referrer);else for(const t of i.MAIMAI_NET_ORIGINS)window.opener.postMessage(e,t)}}t.RootComponent=x},3145:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScorePage=void 0;const i=o(n(7363)),s=n(134),c=n(6358),l=n(7991),d=n(7889),u=n(8625),f=n(9256),m=n(8330),g=n(4639);function p(e,t){return t?"-"+(0,c.formatFloat)(e,t)+"%":"-"+e.toLocaleString("en")}function h(e,t){const n=e?t.achievement:t.finaleAchievement;if(e){if(101===n)return;if(n>=100.5)return{title:"AP+",diff:101-n};const e=(0,l.getRankDefinitions)()[(0,l.getRankIndexByAchievement)(n)-1];return{title:e.title,diff:e.minAchv-n}}let r;return t.finaleBorder.forEach(((e,t)=>{e>0&&!r&&(r={title:t,diff:e})})),r}t.ScorePage=e=>{const{achievement:t,apFcImg:n,rankImg:r,syncImg:a,highScore:o,date:c,songTitle:l,track:x,difficulty:E,songImgSrc:v,noteJudgements:S,combo:_,syncStatus:b,apFcStatus:M,finaleAchievement:y,maxFinaleScore:I,breakDistribution:R,totalJudgements:A,playerScorePerType:N}=e,P=new URLSearchParams(window.location.search).get("gameVersion"),k=(0,s.validateGameVersion)(P,0),[O,T]=(0,i.useState)(k>=13),[L,w]=(0,i.useState)("LOSS"),C=function(e,t,n){if("LOSS"===t){const t=e?n.dx:n.finale,r=e?2:0,a=new Map;return t.forEach(((e,t)=>{a.set(t,{perfect:p(e.perfect,r),great:p(e.great,r),good:p(e.good,r),miss:p(e.miss,r)})})),a}}(O,L,e.achvLossDetail),D=function(e,t,n){const r=e?n.achvLossDetail.dx:n.achvLossDetail.finale;if("LOSS"===t){const t=e?4:0,n=new Map;return r.forEach(((e,r)=>{const a=0===e.total,o=p(e.total,t);n.set(r,{isMax:a,score:o})})),n}return e?n.dxAchvPerType:n.playerScorePerType}(O,L,e);return i.default.createElement("div",{className:"songScoreContainer"},i.default.createElement(u.DateAndPlace,{date:c,isDxMode:O,toggleDxMode:()=>{T(!O)}}),i.default.createElement("div",{className:"songScoreBody"},i.default.createElement("hr",{className:"trackTopLine"}),i.default.createElement(g.SongInfo,{songTitle:l,track:x,difficulty:E}),i.default.createElement(m.SongImg,{imgSrc:v}),i.default.createElement(d.AchievementInfo,{apFcStatus:M,apFcImg:n,rankImgMap:r,syncStatus:b,syncImg:a,isDxMode:O,isHighScore:o,dxAchv:t,finaleAchv:y,maxFinaleAchv:I,showMaxAchv:"NORMAL"!==L,toggleDisplayMode:()=>{w(function(e){switch(e){case"NORMAL":return"LOSS";case"LOSS":return"DETAIL";default:return"NORMAL"}}(L))},fetchRankImage:e.fetchRankImage}),i.default.createElement(f.JudgementContainer,{noteJudgements:C||S,breakDistribution:R,totalJudgements:C?C.get("total"):A,scorePerType:D||N,nextRank:h(O,e),combo:_,isDxMode:O,displayMode:L})))}},1542:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScorePageContainer=void 0;const a=r(n(7363)),o=n(7575),i=n(3145);class s extends a.default.PureComponent{static getDerivedStateFromProps(e){const t=(0,o.calculateScoreInfo)(e.noteJudgements,e.achievement),n=function(e){const t={perfect:0,great:0,good:0,miss:0};return e.forEach((e=>{Object.keys(e).forEach((n=>{let r=n;const a=e[r];"cp"===r&&(r="perfect"),t[r]+=a}))})),t}(e.noteJudgements),r=function(e,t){return e.miss?null:0===t.get("AP+")?"AP+":e.good?"FC":e.great?"FC+":"AP"}(n,t.finaleBorder);return Object.assign(Object.assign({},t),{totalJudgements:n,apFcStatus:r})}render(){return a.default.createElement(i.ScorePage,Object.assign({},this.props,this.state))}}t.ScorePageContainer=s},1334:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SectionSep=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){return a.default.createElement("div",{className:"pageSectionSeparator"})}}t.SectionSep=o},8330:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SongImg=void 0;const a=r(n(7363));class o extends a.default.PureComponent{render(){const{imgSrc:e}=this.props;return a.default.createElement("div",{className:"songImgContainer"},e?a.default.createElement("img",{className:"songImg",src:e,alt:""}):a.default.createElement("div",{className:"songImg songImgPlaceholder"}),a.default.createElement("div",{className:"songImgReflecContainer"},this.getReflecElement(e)))}getReflecElement(e){if(e){const t={backgroundImage:`url("${e}")`};return a.default.createElement("div",{className:"songImgReflec",style:t})}return a.default.createElement("div",{className:"songImgPlaceholder songImgReflecPlaceholder"})}}t.SongImg=o},4639:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SongInfo=void 0;const a=r(n(7363)),o=n(7627),i=a.default.memo((e=>{const{difficulty:t}=e;if(!t)return null;const n=t.toLowerCase().replace(":","");return a.default.createElement("span",{className:"difficulty "+n},"【",a.default.createElement("span",{id:"difficulty"},t),"】")}));class s extends a.default.PureComponent{render(){const{songTitle:e,track:t,difficulty:n}=this.props;return a.default.createElement("div",{className:"songInfoContainer"},a.default.createElement("div",null,a.default.createElement("span",{className:"track",id:"track"},t),a.default.createElement(i,{difficulty:n})),a.default.createElement("h2",{className:"songTitle",id:"songTitle"},a.default.createElement("a",{className:"songWikiLink",href:(0,o.getZhWikiLink)(e),target:"_blank"},e)))}}t.SongInfo=s},1782:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_JUDGEMENT_OBJ=t.BREAK_BONUS_MULTIPLIER=t.BREAK_BASE_SCORE_MULTIPLIER=t.MAX_BREAK_POINTS=t.BREAK_BONUS_POINTS=t.REGULAR_BASE_SCORE_MULTIPLIER=t.BASE_SCORE_PER_TYPE=t.DX_NOTE_TYPES=void 0,t.DX_NOTE_TYPES=["tap","hold","slide","touch","break"],t.BASE_SCORE_PER_TYPE={tap:500,hold:1e3,touch:500,slide:1500,break:2500},t.REGULAR_BASE_SCORE_MULTIPLIER={cp:1,perfect:1,great:.8,good:.5,miss:0},t.BREAK_BONUS_POINTS=100,t.MAX_BREAK_POINTS=t.BASE_SCORE_PER_TYPE.break+t.BREAK_BONUS_POINTS,t.BREAK_BASE_SCORE_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,1],[2500,1],[2e3,.8],[1500,.6],[1250,.5],[1e3,.4],[0,0]]),t.BREAK_BONUS_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,.75],[2500,.5],[2e3,.4],[1500,.4],[1250,.4],[1e3,.3],[0,0]]),t.EMPTY_JUDGEMENT_OBJ={perfect:0,great:0,good:0,miss:0}},7504:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertJudgementsToArray=void 0,t.convertJudgementsToArray=function(e){return"number"==typeof e.cp?[e.cp,e.perfect,e.great,e.good,e.miss]:[e.perfect,e.great,e.good,e.miss]}},1309:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(7363)),o=r(n(1533)),i=n(5268);n(9588),o.default.render(a.default.createElement(i.RootComponent,null),document.getElementById("root"))},4518:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseJudgements=void 0;const n={cp:0,perfect:0,great:0,good:0,miss:0};function r(e,t){const n=e.match(/\d+/g);if(!n)return t;if(n.length<4)throw new Error("Cannot parse note judgements");const r=n.map((e=>parseInt(e,10)));return r.length>4?{cp:r[0],perfect:r[1],great:r[2],good:r[3],miss:r[4]}:{perfect:r[0],great:r[1],good:r[2],miss:r[3]}}t.parseJudgements=function(e){let t=e.split("_");if(1===t.length&&(t=e.split("\n")),t.length<4)throw new Error("Cannot parse note judgement lines");const a=new Map,o=r(t.pop(),n);a.set("break",o);const i=r(t.pop(),void 0);i&&a.set("touch",i);const s=r(t.pop(),n);a.set("slide",s);const c=r(t.pop(),n);a.set("hold",c);const l=r(t.pop(),n);return a.set("tap",l),a}},7575:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateScoreInfo=void 0;const r=n(6358),a=n(7980),o=n(7616),i=n(1782),s=n(7504);function c(e,t,n,a){if("SSS+"===n)return e+t*i.BREAK_BONUS_POINTS-a;const o=e*n-a;return o<0?-1:(0,r.roundFloat)(o,"ceil",50)}t.calculateScoreInfo=function(e,t){let n=0,l=0;const d=new Map([["tap",{score:0,isMax:!1}],["hold",{score:0,isMax:!1}],["slide",{score:0,isMax:!1}],["touch",{score:0,isMax:!1}],["break",{score:0,isMax:!1}],["total",{score:0,isMax:!1}]]),u=new Map;e.forEach(((e,t)=>{const a=i.BASE_SCORE_PER_TYPE[t],o=(0,r.sum)(Object.values(e))*a;if(n+=o,"break"!==t){let n=0;Object.keys(e).forEach((t=>{const r=t,o=e[r];n+=o*a*i.REGULAR_BASE_SCORE_MULTIPLIER[r]}));const r=o-n;d.set(t,{score:n,isMax:0===r}),u.set(t,r),l+=n}}));const f=n/100,m=t-l/f,g=i.BASE_SCORE_PER_TYPE.break/f,p=[],h=e.get("break");(0,o.walkBreakDistributions)(p,new Map,(0,s.convertJudgementsToArray)(h),m,g),console.log("valid break distributions",p);let x=p[0];x||(console.warn("Could not find a valid break distribution!"),console.warn("Please report the issue to the developer."),x=new Map([[i.MAX_BREAK_POINTS,h.cp||0],[2550,0],[2500,h.perfect],[2e3,0],[1500,0],[1250,h.great],[1e3,h.good],[0,h.miss]]));let E=0,v=0;x.forEach(((e,t)=>{E+=e,v+=e*t})),d.set("break",{score:v,isMax:E===x.get(2600)});const S=l+v,_=n+i.BREAK_BONUS_POINTS*E;d.set("total",{score:S,isMax:S===_});const b=(0,r.roundFloat)(S/f,"floor",.01),M=(0,r.roundFloat)(_/f,"floor",.01);console.log("player score per note type",d);const y=new Map;y.set("tap",{score:(0,r.roundFloat)(d.get("tap").score/f,"round",1e-4),isMax:d.get("tap").isMax}),y.set("hold",{score:(0,r.roundFloat)(d.get("hold").score/f,"round",1e-4),isMax:d.get("hold").isMax}),y.set("slide",{score:(0,r.roundFloat)(d.get("slide").score/f,"round",1e-4),isMax:d.get("slide").isMax}),y.set("touch",{score:(0,r.roundFloat)(d.get("touch").score/f,"round",1e-4),isMax:d.get("touch").isMax}),y.set("break",{score:(0,r.roundFloat)(m,"round",1e-4),isMax:d.get("break").isMax}),y.set("total",{score:(0,r.roundFloat)(t,"round",1e-4),isMax:d.get("total").isMax});const I=(0,a.calculateAchvLoss)(e,x,f);console.log("achievement loss detail",I);const R=new Map([["S",c(n,E,.97,S)],["S+",c(n,E,.98,S)],["SS",c(n,E,.99,S)],["SS+",c(n,E,.995,S)],["SSS",c(n,E,1,S)],["SSS+",c(n,E,"SSS+",S)]]),A=new Map,N=500/f,P=1/E;return A.set("tap",N),A.set("hold",2*N),A.set("slide",3*N),A.set("touch",N),A.set("breakDx",5*N+P),A.set("break",5.2*N),{finaleAchievement:b,maxFinaleScore:M,breakDistribution:x,achvLossDetail:I,finaleBorder:R,pctPerNoteType:A,playerScorePerType:d,dxAchvPerType:y}}},8642:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDifficultyTextColor=t.getDifficultyForRecord=t.getDifficultyByName=t.getDifficultyName=t.DIFFICULTY_CLASSNAME_MAP=t.DIFFICULTIES=void 0,t.DIFFICULTIES=[0,1,2,3,4];const n=["BASIC","ADVANCED","EXPERT","MASTER","Re:MASTER"];function r(e){const t=n.indexOf(e.toUpperCase());return t<0?4:t}t.DIFFICULTY_CLASSNAME_MAP=new Map([[0,"basic"],[1,"advanced"],[2,"expert"],[3,"master"],[4,"remaster"]]),t.getDifficultyName=function(e){return n[e]},t.getDifficultyByName=r,t.getDifficultyForRecord=function(e){const t=e.querySelector(".playlog_top_container img.playlog_diff").src;return r(t.substring(t.lastIndexOf("_")+1,t.lastIndexOf(".")))},t.getDifficultyTextColor=function(e){return["#45c124","#ffba01","#ff7b7b","#9f51dc","#dbaaff"][e]}},6162:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGameRegionFromOrigin=t.isMaimaiNetOrigin=t.MAIMAI_NET_ORIGINS=void 0,t.MAIMAI_NET_ORIGINS=["https://maimaidx.jp","https://maimaidx-eng.com"],t.isMaimaiNetOrigin=function(e){return"https://maimaidx.jp"===e||"https://maimaidx-eng.com"===e},t.getGameRegionFromOrigin=function(e){return"https://maimaidx.jp"===e?"https://maimaidx.jp":"https://maimaidx-eng.com"}},134:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionName=t.validateGameVersion=t.RATING_CALCULATOR_SUPPORTED_VERSIONS=t.LATEST_VERSION=void 0;const n=["maimai","maimai PLUS","GreeN","GreeN PLUS","ORANGE","ORANGE PLUS","PiNK","PiNK PLUS","MURASAKi","MURASAKi PLUS","MiLK","MiLK PLUS","FiNALE","maimaiでらっくす","maimaiでらっくす PLUS","Splash","Splash PLUS","UNiVERSE","UNiVERSE PLUS","FESTiVAL","FESTiVAL PLUS"];t.LATEST_VERSION=20,t.RATING_CALCULATOR_SUPPORTED_VERSIONS=[18,19,20],t.validateGameVersion=function(e,n,r=t.LATEST_VERSION){const a="string"==typeof e?parseInt(e):e;return!e||isNaN(a)?r:a>=n&&a<=r?a:r},t.getVersionName=function(e){return n[e]}},9268:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDisplayLv=t.getDefaultLevel=t.getOfficialLevel=t.MAX_LEVEL=void 0,t.MAX_LEVEL=15,t.getOfficialLevel=function(e){const t=Math.floor(e);return e-t>.6?t+"+":t.toString()},t.getDefaultLevel=function(e){if(!e)return 1;const t=parseInt(e);return e.endsWith("+")?t+.7:t},t.getDisplayLv=function(e,t=!1){return(t=t||e<0)?Math.abs(e).toFixed(1)+"~":e.toFixed(1)}},6358:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFloat=t.roundFloat=t.sum=t.compareNumber=void 0,t.compareNumber=function(e,t){return e>t?1:e<t?-1:0},t.sum=function(e){let t=0;for(const n of e)t+=n;return t},t.roundFloat=function(e,t,n){return Math[t](e/n)*n},t.formatFloat=function(e,t){return e?e.toFixed(t):"0"}},7991:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcRecommendedLv=t.getFinaleRankTitle=t.getRankTitle=t.getRankByAchievement=t.getRankIndexByAchievement=t.getRankDefinitions=t.SSSPLUS_MIN_ACHIEVEMENT=void 0;const r=n(9268),a=n(6358);t.SSSPLUS_MIN_ACHIEVEMENT=100.5;const o=[{minAchv:100.5,factor:22.4,title:"SSS+"},{minAchv:100,factor:21.6,title:"SSS"},{minAchv:99.5,factor:21.1,title:"SS+"},{minAchv:99,factor:20.8,title:"SS"},{minAchv:98,factor:20.3,title:"S+"},{minAchv:97,factor:20,title:"S"},{minAchv:94,factor:16.8,title:"AAA"},{minAchv:90,factor:15.2,title:"AA"},{minAchv:80,factor:13.6,title:"A"},{minAchv:75,factor:12,title:"BBB"},{minAchv:70,factor:11.2,title:"BB"},{minAchv:60,factor:9.6,title:"B"},{minAchv:50,factor:8,title:"C"}];function i(){return o}function s(e){return o.findIndex((t=>e>=t.minAchv))}function c(e){const t=s(e);return t<0?"D":o[t].title}t.getRankDefinitions=i,t.getRankIndexByAchievement=s,t.getRankByAchievement=function(e){const t=s(e);return t<0?null:i()[t]},t.getRankTitle=c,t.getFinaleRankTitle=function(e){return c(e).replace("SSS+","SSS")},t.calcRecommendedLv=function(e,t){const n=(0,a.roundFloat)(100*e/t.factor/t.minAchv,"ceil",.1);return n>r.MAX_LEVEL?-1:n}},7627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getZhWikiLink=void 0,t.getZhWikiLink=function(e){return"https://maimai.fandom.com/zh/wiki/"+encodeURIComponent(e)+"?variant=zh-hant"}},7363:e=>{e.exports=React},1533:e=>{e.exports=ReactDOM}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,n(1309)})();